"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var $s=require("detect-browser"),We=require("@walletconnect/time"),ye=require("@walletconnect/window-getters"),js=require("@walletconnect/window-metadata"),Ls=require("viem"),Ps=require("bs58"),Qn=require("@msgpack/msgpack"),ks=require("@scure/base"),Ds=require("@walletconnect/relay-auth"),F=require("uint8arrays"),Vs=require("@walletconnect/relay-api"),Hs=require("blakejs");function Ms(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var ut=Ms(Ps);const At=":";function Wt(e){const[t,n]=e.split(At);return{namespace:t,reference:n}}function er(e){const{namespace:t,reference:n}=e;return[t,n].join(At)}function Xt(e){const[t,n,r]=e.split(At);return{namespace:t,reference:n,address:r}}function tr(e){const{namespace:t,reference:n,address:r}=e;return[t,n,r].join(At)}function Jt(e,t){const n=[];return e.forEach(r=>{const o=t(r);n.includes(o)||n.push(o)}),n}function nr(e){const{address:t}=Xt(e);return t}function rr(e){const{namespace:t,reference:n}=Xt(e);return er({namespace:t,reference:n})}function qs(e,t){const{namespace:n,reference:r}=Wt(t);return tr({namespace:n,reference:r,address:e})}function Ks(e){return Jt(e,nr)}function or(e){return Jt(e,rr)}function Fs(e,t=[]){const n=[];return Object.keys(e).forEach(r=>{if(t.length&&!t.includes(r))return;const o=e[r];n.push(...o.accounts)}),n}function Zs(e,t=[]){const n=[];return Object.keys(e).forEach(r=>{if(t.length&&!t.includes(r))return;const o=e[r];n.push(...or(o.accounts))}),n}function zs(e,t=[]){const n=[];return Object.keys(e).forEach(r=>{if(t.length&&!t.includes(r))return;const o=e[r];n.push(...Bt(r,o))}),n}function Bt(e,t){return e.includes(":")?[e]:t.chains||[]}var Gs=Object.defineProperty,Ys=Object.defineProperties,Ws=Object.getOwnPropertyDescriptors,sr=Object.getOwnPropertySymbols,Xs=Object.prototype.hasOwnProperty,Js=Object.prototype.propertyIsEnumerable,Qt=(e,t,n)=>t in e?Gs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ir=(e,t)=>{for(var n in t||(t={}))Xs.call(t,n)&&Qt(e,n,t[n]);if(sr)for(var n of sr(t))Js.call(t,n)&&Qt(e,n,t[n]);return e},Qs=(e,t)=>Ys(e,Ws(t)),cr=(e,t,n)=>Qt(e,typeof t!="symbol"?t+"":t,n);const fr="ReactNative",ne={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},St=" ",ei=":",ar="/",en=2,ti=1e3,ur="js";function tn(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Be(){return!ye.getDocument()&&!!ye.getNavigator()&&navigator.product===fr}function ni(){return Be()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function ri(){return Be()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Xe(){return!tn()&&!!ye.getNavigator()&&!!ye.getDocument()}function He(){return Be()?ne.reactNative:tn()?ne.node:Xe()?ne.browser:ne.unknown}function oi(){var e;try{return Be()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(e=global.Application)==null?void 0:e.applicationId:void 0}catch{return}}function lr(e,t){const n=new URLSearchParams(e);return Object.entries(t).sort(([r],[o])=>r.localeCompare(o)).forEach(([r,o])=>{o!=null&&n.set(r,String(o))}),n.toString()}function si(e){var t,n;const r=dr();try{return e!=null&&e.url&&r.url&&new URL(e.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),e.url=r.url),(t=e?.icons)!=null&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(o=>o!=="")),Qs(ir(ir({},r),e),{url:e?.url||r.url,name:e?.name||r.name,description:e?.description||r.description,icons:(n=e?.icons)!=null&&n.length&&e.icons.length>0?e.icons:r.icons})}catch(o){return console.warn("Error populating app metadata",o),e||r}}function dr(){return js.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function ii(e,t){var n;const r=He(),o={protocol:e,version:t,env:r};return r==="browser"&&(o.host=((n=ye.getLocation())==null?void 0:n.host)||"unknown"),o}function hr(){if(He()===ne.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const e=$s.detect();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function pr(){var e;const t=He();return t===ne.browser?[t,((e=ye.getLocation())==null?void 0:e.host)||"unknown"].join(":"):t}function gr(e,t,n){const r=hr(),o=pr();return[[e,t].join("-"),[ur,n].join("-"),r,o].join("/")}function ci({protocol:e,version:t,relayUrl:n,sdkVersion:r,auth:o,projectId:s,useOnCloseEvent:i,bundleId:c,packageName:f}){const u=n.split("?"),a=gr(e,t,r),l={auth:o,ua:a,projectId:s,useOnCloseEvent:i||void 0,packageName:f||void 0,bundleId:c||void 0},d=lr(u[1]||"",l);return u[0]+"?"+d}function fi(e){let t=(e.match(/^[^:]+(?=:\/\/)/gi)||[])[0];const n=typeof t<"u"?e.split("://")[1]:e;return t=t==="wss"?"https":"http",[t,n].join("://")}function ai(e,t,n){if(!e[t]||typeof e[t]!==n)throw new Error(`Missing or invalid "${t}" param`)}function br(e,t=en){return yr(e.split(ar),t)}function ui(e){return br(e).join(St)}function Se(e,t){return e.filter(n=>t.includes(n)).length===e.length}function yr(e,t=en){return e.slice(Math.max(e.length-t,0))}function li(e){return Object.fromEntries(e.entries())}function di(e){return new Map(Object.entries(e))}function hi(e,t){const n={};return Object.keys(e).forEach(r=>{n[r]=t(e[r])}),n}const pi=e=>e;function mr(e){return e.trim().replace(/^\w/,t=>t.toUpperCase())}function gi(e){return e.split(St).map(t=>mr(t)).join(St)}function bi(e=We.FIVE_MINUTES,t){const n=We.toMiliseconds(e||We.FIVE_MINUTES);let r,o,s,i;return{resolve:c=>{s&&r&&(clearTimeout(s),r(c),i=Promise.resolve(c))},reject:c=>{s&&o&&(clearTimeout(s),o(c))},done:()=>new Promise((c,f)=>{if(i)return c(i);s=setTimeout(()=>{const u=new Error(t);i=Promise.reject(u),f(u)},n),r=c,o=f})}}function yi(e,t,n){return new Promise(async(r,o)=>{const s=setTimeout(()=>o(new Error(n)),t);try{const i=await e;r(i)}catch(i){o(i)}clearTimeout(s)})}function nn(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function mi(e){return nn("topic",e)}function wi(e){return nn("id",e)}function vi(e){const[t,n]=e.split(":"),r={id:void 0,topic:void 0};if(t==="topic"&&typeof n=="string")r.topic=n;else if(t==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${n}`);return r}function Ei(e,t){return We.fromMiliseconds((t||Date.now())+We.toMiliseconds(e))}function xi(e){return Date.now()>=We.toMiliseconds(e)}function Ai(e,t){return`${e}${t?`:${t}`:""}`}function ae(e=[],t=[]){return[...new Set([...e,...t])]}async function Bi({id:e,topic:t,wcDeepLink:n}){var r;try{if(!n)return;const o=typeof n=="string"?JSON.parse(n):n,s=o?.href;if(typeof s!="string")return;const i=wr(s,e,t),c=He();if(c===ne.browser){if(!((r=ye.getDocument())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}vr(i)}else c===ne.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(i)}catch(o){console.error(o)}}function wr(e,t,n){const r=`requestId=${t}&sessionTopic=${n}`;e.endsWith("/")&&(e=e.slice(0,-1));let o=`${e}`;if(e.startsWith("https://t.me")){const s=e.includes("?")?"&startapp=":"?startapp=";o=`${o}${s}${Ar(r,!0)}`}else o=`${o}/wc?${r}`;return o}function vr(e){let t="_self";xr()?t="_top":(Er()||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"),window.open(e,t,"noreferrer noopener")}async function Si(e,t){let n="";try{if(Xe()&&(n=localStorage.getItem(t),n))return n;n=await e.getItem(t)}catch(r){console.error(r)}return n}function rn(e,t){return e.filter(n=>t.includes(n))}function Ii(e,t){if(!e.includes(t))return null;const n=e.split(/([&,?,=])/),r=n.indexOf(t);return n[r+2]}function Oi(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Ni(){return typeof process<"u"&&process.env.IS_VITEST==="true"}function Er(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function xr(){try{return window.self!==window.top}catch{return!1}}function Ar(e,t=!1){const n=Buffer.from(e).toString("base64");return t?n.replace(/[=]/g,""):n}function on(e){return Buffer.from(e,"base64").toString("utf-8")}function Ri(e){return new Promise(t=>setTimeout(t,e))}class Ui{constructor({limit:t}){cr(this,"limit"),cr(this,"set"),this.limit=t,this.set=new Set}add(t){if(!this.set.has(t)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(t)}}has(t){return this.set.has(t)}}const It=BigInt(2**32-1),Br=BigInt(32);function Sr(e,t=!1){return t?{h:Number(e&It),l:Number(e>>Br&It)}:{h:Number(e>>Br&It)|0,l:Number(e&It)|0}}function Ir(e,t=!1){const n=e.length;let r=new Uint32Array(n),o=new Uint32Array(n);for(let s=0;s<n;s++){const{h:i,l:c}=Sr(e[s],t);[r[s],o[s]]=[i,c]}return[r,o]}const Or=(e,t,n)=>e>>>n,Nr=(e,t,n)=>e<<32-n|t>>>n,Ie=(e,t,n)=>e>>>n|t<<32-n,Oe=(e,t,n)=>e<<32-n|t>>>n,lt=(e,t,n)=>e<<64-n|t>>>n-32,dt=(e,t,n)=>e>>>n-32|t<<64-n,_i=(e,t)=>t,Ti=(e,t)=>e,Ci=(e,t,n)=>e<<n|t>>>32-n,$i=(e,t,n)=>t<<n|e>>>32-n,ji=(e,t,n)=>t<<n-32|e>>>64-n,Li=(e,t,n)=>e<<n-32|t>>>64-n;function le(e,t,n,r){const o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}const sn=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),cn=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Pi=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),ki=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,Di=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),Vi=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0,Je=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Ot(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function me(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function de(e,...t){if(!Ot(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Nt(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");me(e.outputLen),me(e.blockLen)}function Ne(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function fn(e,t){de(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function ht(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function ue(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function an(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function ge(e,t){return e<<32-t|e>>>t}const Rr=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ur(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const we=Rr?e=>e:e=>Ur(e);function Hi(e){for(let t=0;t<e.length;t++)e[t]=Ur(e[t]);return e}const Re=Rr?e=>e:Hi,_r=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Mi=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Qe(e){if(de(e),_r)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=Mi[e[n]];return t}const ve={_0:48,_9:57,A:65,F:70,a:97,f:102};function Tr(e){if(e>=ve._0&&e<=ve._9)return e-ve._0;if(e>=ve.A&&e<=ve.F)return e-(ve.A-10);if(e>=ve.a&&e<=ve.f)return e-(ve.a-10)}function Rt(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(_r)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){const i=Tr(e.charCodeAt(s)),c=Tr(e.charCodeAt(s+1));if(i===void 0||c===void 0){const f=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+s)}r[o]=i*16+c}return r}function Cr(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function he(e){return typeof e=="string"&&(e=Cr(e)),de(e),e}function Ue(...e){let t=0;for(let r=0;r<e.length;r++){const o=e[r];de(o),t+=o.length}const n=new Uint8Array(t);for(let r=0,o=0;r<e.length;r++){const s=e[r];n.set(s,o),o+=s.length}return n}class Ut{}function pt(e){const t=r=>e().update(he(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function qi(e){const t=(r,o)=>e(o).update(he(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function Me(e=32){if(Je&&typeof Je.getRandomValues=="function")return Je.getRandomValues(new Uint8Array(e));if(Je&&typeof Je.randomBytes=="function")return Uint8Array.from(Je.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const Ki=BigInt(0),gt=BigInt(1),Fi=BigInt(2),Zi=BigInt(7),zi=BigInt(256),Gi=BigInt(113),$r=[],jr=[],Lr=[];for(let e=0,t=gt,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],$r.push(2*(5*r+n)),jr.push((e+1)*(e+2)/2%64);let o=Ki;for(let s=0;s<7;s++)t=(t<<gt^(t>>Zi)*Gi)%zi,t&Fi&&(o^=gt<<(gt<<BigInt(s))-gt);Lr.push(o)}const Pr=Ir(Lr,!0),Yi=Pr[0],Wi=Pr[1],kr=(e,t,n)=>n>32?ji(e,t,n):Ci(e,t,n),Dr=(e,t,n)=>n>32?Li(e,t,n):$i(e,t,n);function Xi(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let i=0;i<10;i++)n[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(let i=0;i<10;i+=2){const c=(i+8)%10,f=(i+2)%10,u=n[f],a=n[f+1],l=kr(u,a,1)^n[c],d=Dr(u,a,1)^n[c+1];for(let h=0;h<50;h+=10)e[i+h]^=l,e[i+h+1]^=d}let o=e[2],s=e[3];for(let i=0;i<24;i++){const c=jr[i],f=kr(o,s,c),u=Dr(o,s,c),a=$r[i];o=e[a],s=e[a+1],e[a]=f,e[a+1]=u}for(let i=0;i<50;i+=10){for(let c=0;c<10;c++)n[c]=e[i+c];for(let c=0;c<10;c++)e[i+c]^=~n[(c+2)%10]&n[(c+4)%10]}e[0]^=Yi[r],e[1]^=Wi[r]}ue(n)}class Wn extends Ut{constructor(t,n,r,o=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=o,this.rounds=s,me(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=ht(this.state)}clone(){return this._cloneInto()}keccak(){Re(this.state32),Xi(this.state32,this.rounds),Re(this.state32),this.posOut=0,this.pos=0}update(t){Ne(this),t=he(t),de(t);const{blockLen:n,state:r}=this,o=t.length;for(let s=0;s<o;){const i=Math.min(n-this.pos,o-s);for(let c=0;c<i;c++)r[this.pos++]^=t[s++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:o}=this;t[r]^=n,(n&128)!==0&&r===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){Ne(this,!1),de(t),this.finish();const n=this.state,{blockLen:r}=this;for(let o=0,s=t.length;o<s;){this.posOut>=r&&this.keccak();const i=Math.min(r-this.posOut,s-o);t.set(n.subarray(this.posOut,this.posOut+i),o),this.posOut+=i,o+=i}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return me(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(fn(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,ue(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:o,rounds:s,enableXOF:i}=this;return t||(t=new Wn(n,r,o,i,s)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=s,t.suffix=r,t.outputLen=o,t.enableXOF=i,t.destroyed=this.destroyed,t}}const Ji=(e,t,n)=>pt(()=>new Wn(t,e,n)),Qi=Ji(1,136,256/8);function ec(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,u=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+u,c,r)}function tc(e,t,n){return e&t^~e&n}function nc(e,t,n){return e&t^e&n^t&n}class Vr extends Ut{constructor(t,n,r,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=an(this.buffer)}update(t){Ne(this),t=he(t),de(t);const{view:n,buffer:r,blockLen:o}=this,s=t.length;for(let i=0;i<s;){const c=Math.min(o-this.pos,s-i);if(c===o){const f=an(t);for(;o<=s-i;i+=o)this.process(f,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ne(this),fn(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:o,isLE:s}=this;let{pos:i}=this;n[i++]=128,ue(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(r,0),i=0);for(let l=i;l<o;l++)n[l]=0;ec(r,o-8,BigInt(this.length*8),s),this.process(r,0);const c=an(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=f/4,a=this.get();if(u>a.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)c.setUint32(4*l,a[l],s)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:o,finished:s,destroyed:i,pos:c}=this;return t.destroyed=i,t.finished=s,t.length=o,t.pos=c,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const _e=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),J=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Q=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),rc=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Te=new Uint32Array(64);class oc extends Vr{constructor(t=32){super(64,t,8,!1),this.A=_e[0]|0,this.B=_e[1]|0,this.C=_e[2]|0,this.D=_e[3]|0,this.E=_e[4]|0,this.F=_e[5]|0,this.G=_e[6]|0,this.H=_e[7]|0}get(){const{A:t,B:n,C:r,D:o,E:s,F:i,G:c,H:f}=this;return[t,n,r,o,s,i,c,f]}set(t,n,r,o,s,i,c,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=c|0,this.H=f|0}process(t,n){for(let l=0;l<16;l++,n+=4)Te[l]=t.getUint32(n,!1);for(let l=16;l<64;l++){const d=Te[l-15],h=Te[l-2],y=ge(d,7)^ge(d,18)^d>>>3,m=ge(h,17)^ge(h,19)^h>>>10;Te[l]=m+Te[l-7]+y+Te[l-16]|0}let{A:r,B:o,C:s,D:i,E:c,F:f,G:u,H:a}=this;for(let l=0;l<64;l++){const d=ge(c,6)^ge(c,11)^ge(c,25),h=a+d+tc(c,f,u)+rc[l]+Te[l]|0,m=(ge(r,2)^ge(r,13)^ge(r,22))+nc(r,o,s)|0;a=u,u=f,f=c,c=i+h|0,i=s,s=o,o=r,r=h+m|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,c=c+this.E|0,f=f+this.F|0,u=u+this.G|0,a=a+this.H|0,this.set(r,o,s,i,c,f,u,a)}roundClean(){ue(Te)}destroy(){this.set(0,0,0,0,0,0,0,0),ue(this.buffer)}}const Hr=Ir(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),sc=Hr[0],ic=Hr[1],Ce=new Uint32Array(80),$e=new Uint32Array(80);class un extends Vr{constructor(t=64){super(128,t,16,!1),this.Ah=Q[0]|0,this.Al=Q[1]|0,this.Bh=Q[2]|0,this.Bl=Q[3]|0,this.Ch=Q[4]|0,this.Cl=Q[5]|0,this.Dh=Q[6]|0,this.Dl=Q[7]|0,this.Eh=Q[8]|0,this.El=Q[9]|0,this.Fh=Q[10]|0,this.Fl=Q[11]|0,this.Gh=Q[12]|0,this.Gl=Q[13]|0,this.Hh=Q[14]|0,this.Hl=Q[15]|0}get(){const{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:i,Dh:c,Dl:f,Eh:u,El:a,Fh:l,Fl:d,Gh:h,Gl:y,Hh:m,Hl:v}=this;return[t,n,r,o,s,i,c,f,u,a,l,d,h,y,m,v]}set(t,n,r,o,s,i,c,f,u,a,l,d,h,y,m,v){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=c|0,this.Dl=f|0,this.Eh=u|0,this.El=a|0,this.Fh=l|0,this.Fl=d|0,this.Gh=h|0,this.Gl=y|0,this.Hh=m|0,this.Hl=v|0}process(t,n){for(let _=0;_<16;_++,n+=4)Ce[_]=t.getUint32(n),$e[_]=t.getUint32(n+=4);for(let _=16;_<80;_++){const z=Ce[_-15]|0,D=$e[_-15]|0,j=Ie(z,D,1)^Ie(z,D,8)^Or(z,D,7),L=Oe(z,D,1)^Oe(z,D,8)^Nr(z,D,7),P=Ce[_-2]|0,O=$e[_-2]|0,C=Ie(P,O,19)^lt(P,O,61)^Or(P,O,6),$=Oe(P,O,19)^dt(P,O,61)^Nr(P,O,6),U=Pi(L,$,$e[_-7],$e[_-16]),p=ki(U,j,C,Ce[_-7],Ce[_-16]);Ce[_]=p|0,$e[_]=U|0}let{Ah:r,Al:o,Bh:s,Bl:i,Ch:c,Cl:f,Dh:u,Dl:a,Eh:l,El:d,Fh:h,Fl:y,Gh:m,Gl:v,Hh:R,Hl:Z}=this;for(let _=0;_<80;_++){const z=Ie(l,d,14)^Ie(l,d,18)^lt(l,d,41),D=Oe(l,d,14)^Oe(l,d,18)^dt(l,d,41),j=l&h^~l&m,L=d&y^~d&v,P=Di(Z,D,L,ic[_],$e[_]),O=Vi(P,R,z,j,sc[_],Ce[_]),C=P|0,$=Ie(r,o,28)^lt(r,o,34)^lt(r,o,39),U=Oe(r,o,28)^dt(r,o,34)^dt(r,o,39),p=r&s^r&c^s&c,b=o&i^o&f^i&f;R=m|0,Z=v|0,m=h|0,v=y|0,h=l|0,y=d|0,{h:l,l:d}=le(u|0,a|0,O|0,C|0),u=c|0,a=f|0,c=s|0,f=i|0,s=r|0,i=o|0;const g=sn(C,U,b);r=cn(g,O,$,p),o=g|0}({h:r,l:o}=le(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:i}=le(this.Bh|0,this.Bl|0,s|0,i|0),{h:c,l:f}=le(this.Ch|0,this.Cl|0,c|0,f|0),{h:u,l:a}=le(this.Dh|0,this.Dl|0,u|0,a|0),{h:l,l:d}=le(this.Eh|0,this.El|0,l|0,d|0),{h,l:y}=le(this.Fh|0,this.Fl|0,h|0,y|0),{h:m,l:v}=le(this.Gh|0,this.Gl|0,m|0,v|0),{h:R,l:Z}=le(this.Hh|0,this.Hl|0,R|0,Z|0),this.set(r,o,s,i,c,f,u,a,l,d,h,y,m,v,R,Z)}roundClean(){ue(Ce,$e)}destroy(){ue(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class cc extends un{constructor(){super(48),this.Ah=J[0]|0,this.Al=J[1]|0,this.Bh=J[2]|0,this.Bl=J[3]|0,this.Ch=J[4]|0,this.Cl=J[5]|0,this.Dh=J[6]|0,this.Dl=J[7]|0,this.Eh=J[8]|0,this.El=J[9]|0,this.Fh=J[10]|0,this.Fl=J[11]|0,this.Gh=J[12]|0,this.Gl=J[13]|0,this.Hh=J[14]|0,this.Hl=J[15]|0}}const ee=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class fc extends un{constructor(){super(32),this.Ah=ee[0]|0,this.Al=ee[1]|0,this.Bh=ee[2]|0,this.Bl=ee[3]|0,this.Ch=ee[4]|0,this.Cl=ee[5]|0,this.Dh=ee[6]|0,this.Dl=ee[7]|0,this.Eh=ee[8]|0,this.El=ee[9]|0,this.Fh=ee[10]|0,this.Fl=ee[11]|0,this.Gh=ee[12]|0,this.Gl=ee[13]|0,this.Hh=ee[14]|0,this.Hl=ee[15]|0}}const _t=pt(()=>new oc),ac=pt(()=>new un),uc=pt(()=>new cc),lc=pt(()=>new fc),dc=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),Y=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),I=new Uint32Array(32);function je(e,t,n,r,o,s){const i=o[s],c=o[s+1];let f=I[2*e],u=I[2*e+1],a=I[2*t],l=I[2*t+1],d=I[2*n],h=I[2*n+1],y=I[2*r],m=I[2*r+1],v=sn(f,a,i);u=cn(v,u,l,c),f=v|0,{Dh:m,Dl:y}={Dh:m^u,Dl:y^f},{Dh:m,Dl:y}={Dh:_i(m,y),Dl:Ti(m)},{h,l:d}=le(h,d,m,y),{Bh:l,Bl:a}={Bh:l^h,Bl:a^d},{Bh:l,Bl:a}={Bh:Ie(l,a,24),Bl:Oe(l,a,24)},I[2*e]=f,I[2*e+1]=u,I[2*t]=a,I[2*t+1]=l,I[2*n]=d,I[2*n+1]=h,I[2*r]=y,I[2*r+1]=m}function Le(e,t,n,r,o,s){const i=o[s],c=o[s+1];let f=I[2*e],u=I[2*e+1],a=I[2*t],l=I[2*t+1],d=I[2*n],h=I[2*n+1],y=I[2*r],m=I[2*r+1],v=sn(f,a,i);u=cn(v,u,l,c),f=v|0,{Dh:m,Dl:y}={Dh:m^u,Dl:y^f},{Dh:m,Dl:y}={Dh:Ie(m,y,16),Dl:Oe(m,y,16)},{h,l:d}=le(h,d,m,y),{Bh:l,Bl:a}={Bh:l^h,Bl:a^d},{Bh:l,Bl:a}={Bh:lt(l,a,63),Bl:dt(l,a,63)},I[2*e]=f,I[2*e+1]=u,I[2*t]=a,I[2*t+1]=l,I[2*n]=d,I[2*n+1]=h,I[2*r]=y,I[2*r+1]=m}function hc(e,t={},n,r,o){if(me(n),e<0||e>n)throw new Error("outputLen bigger than keyLen");const{key:s,salt:i,personalization:c}=t;if(s!==void 0&&(s.length<1||s.length>n))throw new Error("key length must be undefined or 1.."+n);if(i!==void 0&&i.length!==r)throw new Error("salt must be undefined or "+r);if(c!==void 0&&c.length!==o)throw new Error("personalization must be undefined or "+o)}class pc extends Ut{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,me(t),me(n),this.blockLen=t,this.outputLen=n,this.buffer=new Uint8Array(t),this.buffer32=ht(this.buffer)}update(t){Ne(this),t=he(t),de(t);const{blockLen:n,buffer:r,buffer32:o}=this,s=t.length,i=t.byteOffset,c=t.buffer;for(let f=0;f<s;){this.pos===n&&(Re(o),this.compress(o,0,!1),Re(o),this.pos=0);const u=Math.min(n-this.pos,s-f),a=i+f;if(u===n&&!(a%4)&&f+u<s){const l=new Uint32Array(c,a,Math.floor((s-f)/4));Re(l);for(let d=0;f+n<s;d+=o.length,f+=n)this.length+=n,this.compress(l,d,!1);Re(l);continue}r.set(t.subarray(f,f+u),this.pos),this.pos+=u,this.length+=u,f+=u}return this}digestInto(t){Ne(this),fn(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,ue(this.buffer.subarray(n)),Re(r),this.compress(r,0,!0),Re(r);const o=ht(t);this.get().forEach((s,i)=>o[i]=we(s))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:o,destroyed:s,outputLen:i,pos:c}=this;return t||(t=new this.constructor({dkLen:i})),t.set(...this.get()),t.buffer.set(n),t.destroyed=s,t.finished=o,t.length=r,t.pos=c,t.outputLen=i,t}clone(){return this._cloneInto()}}class gc extends pc{constructor(t={}){const n=t.dkLen===void 0?64:t.dkLen;super(128,n),this.v0l=Y[0]|0,this.v0h=Y[1]|0,this.v1l=Y[2]|0,this.v1h=Y[3]|0,this.v2l=Y[4]|0,this.v2h=Y[5]|0,this.v3l=Y[6]|0,this.v3h=Y[7]|0,this.v4l=Y[8]|0,this.v4h=Y[9]|0,this.v5l=Y[10]|0,this.v5h=Y[11]|0,this.v6l=Y[12]|0,this.v6h=Y[13]|0,this.v7l=Y[14]|0,this.v7h=Y[15]|0,hc(n,t,64,16,16);let{key:r,personalization:o,salt:s}=t,i=0;if(r!==void 0&&(r=he(r),i=r.length),this.v0l^=this.outputLen|i<<8|65536|1<<24,s!==void 0){s=he(s);const c=ht(s);this.v4l^=we(c[0]),this.v4h^=we(c[1]),this.v5l^=we(c[2]),this.v5h^=we(c[3])}if(o!==void 0){o=he(o);const c=ht(o);this.v6l^=we(c[0]),this.v6h^=we(c[1]),this.v7l^=we(c[2]),this.v7h^=we(c[3])}if(r!==void 0){const c=new Uint8Array(this.blockLen);c.set(r),this.update(c)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:o,v2l:s,v2h:i,v3l:c,v3h:f,v4l:u,v4h:a,v5l:l,v5h:d,v6l:h,v6h:y,v7l:m,v7h:v}=this;return[t,n,r,o,s,i,c,f,u,a,l,d,h,y,m,v]}set(t,n,r,o,s,i,c,f,u,a,l,d,h,y,m,v){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=o|0,this.v2l=s|0,this.v2h=i|0,this.v3l=c|0,this.v3h=f|0,this.v4l=u|0,this.v4h=a|0,this.v5l=l|0,this.v5h=d|0,this.v6l=h|0,this.v6h=y|0,this.v7l=m|0,this.v7h=v|0}compress(t,n,r){this.get().forEach((f,u)=>I[u]=f),I.set(Y,16);let{h:o,l:s}=Sr(BigInt(this.length));I[24]=Y[8]^s,I[25]=Y[9]^o,r&&(I[28]=~I[28],I[29]=~I[29]);let i=0;const c=dc;for(let f=0;f<12;f++)je(0,4,8,12,t,n+2*c[i++]),Le(0,4,8,12,t,n+2*c[i++]),je(1,5,9,13,t,n+2*c[i++]),Le(1,5,9,13,t,n+2*c[i++]),je(2,6,10,14,t,n+2*c[i++]),Le(2,6,10,14,t,n+2*c[i++]),je(3,7,11,15,t,n+2*c[i++]),Le(3,7,11,15,t,n+2*c[i++]),je(0,5,10,15,t,n+2*c[i++]),Le(0,5,10,15,t,n+2*c[i++]),je(1,6,11,12,t,n+2*c[i++]),Le(1,6,11,12,t,n+2*c[i++]),je(2,7,8,13,t,n+2*c[i++]),Le(2,7,8,13,t,n+2*c[i++]),je(3,4,9,14,t,n+2*c[i++]),Le(3,4,9,14,t,n+2*c[i++]);this.v0l^=I[0]^I[16],this.v0h^=I[1]^I[17],this.v1l^=I[2]^I[18],this.v1h^=I[3]^I[19],this.v2l^=I[4]^I[20],this.v2h^=I[5]^I[21],this.v3l^=I[6]^I[22],this.v3h^=I[7]^I[23],this.v4l^=I[8]^I[24],this.v4h^=I[9]^I[25],this.v5l^=I[10]^I[26],this.v5h^=I[11]^I[27],this.v6l^=I[12]^I[28],this.v6h^=I[13]^I[29],this.v7l^=I[14]^I[30],this.v7h^=I[15]^I[31],ue(I)}destroy(){this.destroyed=!0,ue(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const bc=qi(e=>new gc(e)),yc="https://rpc.walletconnect.org/v1";function ln(e){const t=`Ethereum Signed Message:
${e.length}`,n=new TextEncoder().encode(t+e);return"0x"+Buffer.from(Qi(n)).toString("hex")}async function Mr(e,t,n,r,o,s){switch(n.t){case"eip191":return await qr(e,t,n.s);case"eip1271":return await Kr(e,t,n.s,r,o,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}async function qr(e,t,n){return(await Ls.recoverAddress({hash:ln(t),signature:n})).toLowerCase()===e.toLowerCase()}async function Kr(e,t,n,r,o,s){const i=Wt(r);if(!i.namespace||!i.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const c="0x1626ba7e",f="0000000000000000000000000000000000000000000000000000000000000040",u=n.substring(2),a=(u.length/2).toString(16).padStart(64,"0"),l=(t.startsWith("0x")?t:ln(t)).substring(2),d=c+l+f+a+u,h=await fetch(`${s||yc}/?chainId=${r}&projectId=${o}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:mc(),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:d},"latest"]})}),{result:y}=await h.json();return y?y.slice(0,c.length).toLowerCase()===c.toLowerCase():!1}catch(c){return console.error("isValidEip1271Signature: ",c),!1}}function mc(){return Date.now()+Math.floor(Math.random()*1e3)}function wc(e){const t=atob(e),n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);const r=n[0];if(r===0)throw new Error("No signatures found");const o=1+r*64;if(n.length<o)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const s=Buffer.from(e,"base64").slice(1,65);return ut.default.encode(s)}function vc(e){const t=new Uint8Array(Buffer.from(e,"base64")),n=Array.from("TransactionData::").map(s=>s.charCodeAt(0)),r=new Uint8Array(n.length+t.length);r.set(n),r.set(t,n.length);const o=bc(r,{dkLen:32});return ut.default.encode(o)}function Ec(e){const t=new Uint8Array(_t(Fr(e)));return ut.default.encode(t)}function Fr(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if(typeof e=="object"&&e!=null&&e.data)return new Uint8Array(Object.values(e.data));if(typeof e=="object"&&e)return new Uint8Array(Object.values(e));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function xc(e){const t=Buffer.from(e,"base64"),n=Qn.decode(t).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=Qn.encode(n),o=Buffer.from("TX"),s=Buffer.concat([o,Buffer.from(r)]),i=lc(s);return ks.base32.encode(i).replace(/=+$/,"")}function dn(e){const t=[];let n=BigInt(e);for(;n>=BigInt(128);)t.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return t.push(Number(n)),Buffer.from(t)}function Ac(e){const t=Buffer.from(e.signed.bodyBytes,"base64"),n=Buffer.from(e.signed.authInfoBytes,"base64"),r=Buffer.from(e.signature.signature,"base64"),o=[];o.push(Buffer.from([10])),o.push(dn(t.length)),o.push(t),o.push(Buffer.from([18])),o.push(dn(n.length)),o.push(n),o.push(Buffer.from([26])),o.push(dn(r.length)),o.push(r);const s=Buffer.concat(o),i=_t(s);return Buffer.from(i).toString("hex").toUpperCase()}function Bc(e){var t,n;const r=[];try{if(typeof e=="string")return r.push(e),r;if(typeof e!="object")return r;e!=null&&e.id&&r.push(e.id);const o=(n=(t=e?.capabilities)==null?void 0:t.caip345)==null?void 0:n.transactionHashes;o&&r.push(...o)}catch(o){console.warn("getWalletSendCallsHashes failed: ",o)}return r}var Sc=Object.defineProperty,Ic=Object.defineProperties,Oc=Object.getOwnPropertyDescriptors,Zr=Object.getOwnPropertySymbols,Nc=Object.prototype.hasOwnProperty,Rc=Object.prototype.propertyIsEnumerable,zr=(e,t,n)=>t in e?Sc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,hn=(e,t)=>{for(var n in t||(t={}))Nc.call(t,n)&&zr(e,n,t[n]);if(Zr)for(var n of Zr(t))Rc.call(t,n)&&zr(e,n,t[n]);return e},Gr=(e,t)=>Ic(e,Oc(t));const Uc="did:pkh:",Tt=e=>e?.split(":"),Yr=e=>{const t=e&&Tt(e);if(t)return e.includes(Uc)?t[3]:t[1]},Wr=e=>{const t=e&&Tt(e);if(t)return t[2]+":"+t[3]},pn=e=>{const t=e&&Tt(e);if(t)return t.pop()};async function _c(e){const{cacao:t,projectId:n}=e,{s:r,p:o}=t,s=Xr(o,o.iss),i=pn(o.iss);return await Mr(i,s,r,Wr(o.iss),n)}const Xr=(e,t)=>{const n=`${e.domain} wants you to sign in with your Ethereum account:`,r=pn(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let o=e.statement||void 0;const s=`URI: ${e.aud||e.uri}`,i=`Version: ${e.version}`,c=`Chain ID: ${Yr(t)}`,f=`Nonce: ${e.nonce}`,u=`Issued At: ${e.iat}`,a=e.exp?`Expiration Time: ${e.exp}`:void 0,l=e.nbf?`Not Before: ${e.nbf}`:void 0,d=e.requestId?`Request ID: ${e.requestId}`:void 0,h=e.resources?`Resources:${e.resources.map(m=>`
- ${m}`).join("")}`:void 0,y=$t(e.resources);if(y){const m=Pe(y);o=yn(o,m)}return[n,r,"",o,"",s,i,c,f,u,a,l,d,h].filter(m=>m!=null).join(`
`)};function Tc(e,t,n){return n.includes("did:pkh:")||(n=`did:pkh:${n}`),{h:{t:"caip122"},p:{iss:n,domain:e.domain,aud:e.aud,version:e.version,nonce:e.nonce,iat:e.iat,statement:e.statement,requestId:e.requestId,resources:e.resources,nbf:e.nbf,exp:e.exp},s:t}}function Cc(e){var t;const{authPayload:n,chains:r,methods:o}=e,s=n.statement||"";if(!(r!=null&&r.length))return n;const i=n.chains,c=rn(i,r);if(!(c!=null&&c.length))throw new Error("No supported chains");const f=Jr(n.resources);if(!f)return n;be(f);const u=Qr(f,"eip155");let a=n?.resources||[];if(u!=null&&u.length){const l=eo(u),d=rn(l,o);if(!(d!=null&&d.length))throw new Error(`Supported methods don't satisfy the requested: ${JSON.stringify(l)}, supported: ${JSON.stringify(o)}`);const h=gn("request",d,{chains:c}),y=oo(f,"eip155",h);a=((t=n?.resources)==null?void 0:t.slice(0,-1))||[],a.push(Ct(y))}return Gr(hn({},n),{statement:io(s,$t(a)),chains:c,resources:n!=null&&n.resources||a.length>0?a:void 0})}function Jr(e){const t=$t(e);if(t&&bn(t))return Pe(t)}function $c(e,t){var n;return(n=e?.att)==null?void 0:n.hasOwnProperty(t)}function Qr(e,t){var n,r;return(n=e?.att)!=null&&n[t]?Object.keys((r=e?.att)==null?void 0:r[t]):[]}function jc(e){return e?.map(t=>Object.keys(t))||[]}function eo(e){return e?.map(t=>{var n;return(n=t.split("/"))==null?void 0:n[1]})||[]}function to(e){return Buffer.from(JSON.stringify(e)).toString("base64")}function no(e){return JSON.parse(Buffer.from(e,"base64").toString("utf-8"))}function be(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");const t=Object.keys(e.att);if(!(t!=null&&t.length))throw new Error("No resources found in `att` property");t.forEach(n=>{const r=e.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(o=>{const s=r[o];if(!Array.isArray(s))throw new Error(`Ability limits ${o} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${o} is empty array, must be an array with objects`);s.forEach(i=>{if(typeof i!="object")throw new Error(`Ability limits (${o}) must be an array of objects, found: ${i}`)})})})}function ro(e,t,n,r={}){return n?.sort((o,s)=>o.localeCompare(s)),{att:{[e]:gn(t,n,r)}}}function oo(e,t,n){var r;e.att[t]=hn({},n);const o=(r=Object.keys(e.att))==null?void 0:r.sort((i,c)=>i.localeCompare(c)),s={att:{}};return o.reduce((i,c)=>(i.att[c]=e.att[c],i),s)}function gn(e,t,n={}){t=t?.sort((o,s)=>o.localeCompare(s));const r=t.map(o=>({[`${e}/${o}`]:[n]}));return Object.assign({},...r)}function Ct(e){return be(e),`urn:recap:${to(e).replace(/=/g,"")}`}function Pe(e){const t=no(e.replace("urn:recap:",""));return be(t),t}function Lc(e,t,n){const r=ro(e,t,n);return Ct(r)}function bn(e){return e&&e.includes("urn:recap:")}function Pc(e,t){const n=Pe(e),r=Pe(t),o=so(n,r);return Ct(o)}function so(e,t){be(e),be(t);const n=Object.keys(e.att).concat(Object.keys(t.att)).sort((o,s)=>o.localeCompare(s)),r={att:{}};return n.forEach(o=>{var s,i;Object.keys(((s=e.att)==null?void 0:s[o])||{}).concat(Object.keys(((i=t.att)==null?void 0:i[o])||{})).sort((c,f)=>c.localeCompare(f)).forEach(c=>{var f,u;r.att[o]=Gr(hn({},r.att[o]),{[c]:((f=e.att[o])==null?void 0:f[c])||((u=t.att[o])==null?void 0:u[c])})})}),r}function yn(e="",t){be(t);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(n))return e;const r=[];let o=0;Object.keys(t.att).forEach(c=>{const f=Object.keys(t.att[c]).map(l=>({ability:l.split("/")[0],action:l.split("/")[1]}));f.sort((l,d)=>l.action.localeCompare(d.action));const u={};f.forEach(l=>{u[l.ability]||(u[l.ability]=[]),u[l.ability].push(l.action)});const a=Object.keys(u).map(l=>(o++,`(${o}) '${l}': '${u[l].join("', '")}' for '${c}'.`));r.push(a.join(", ").replace(".,","."))});const s=r.join(" "),i=`${n}${s}`;return`${e?e+" ":""}${i}`}function kc(e){var t;const n=Pe(e);be(n);const r=(t=n.att)==null?void 0:t.eip155;return r?Object.keys(r).map(o=>o.split("/")[1]):[]}function Dc(e){const t=Pe(e);be(t);const n=[];return Object.values(t.att).forEach(r=>{Object.values(r).forEach(o=>{var s;(s=o?.[0])!=null&&s.chains&&n.push(o[0].chains)})}),[...new Set(n.flat())]}function io(e,t){if(!t)return e;const n=Pe(t);return be(n),yn(e,n)}function $t(e){if(!e)return;const t=e?.[e.length-1];return bn(t)?t:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function co(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function mn(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function wn(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function se(e,...t){if(!co(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function fo(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Vc(e,t){se(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function ke(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function et(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Hc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const Mc=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function qc(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function vn(e){if(typeof e=="string")e=qc(e);else if(co(e))e=En(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function Kc(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function Fc(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}const Zc=(e,t)=>{function n(r,...o){if(se(r),!Mc)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){const a=o[0];if(!a)throw new Error("nonce / iv required");e.varSizeNonce?se(a):se(a,e.nonceLength)}const s=e.tagLength;s&&o[1]!==void 0&&se(o[1]);const i=t(r,...o),c=(a,l)=>{if(l!==void 0){if(a!==2)throw new Error("cipher output not supported");se(l)}};let f=!1;return{encrypt(a,l){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,se(a),c(i.encrypt.length,l),i.encrypt(a,l)},decrypt(a,l){if(se(a),s&&a.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return c(i.decrypt.length,l),i.decrypt(a,l)}}}return Object.assign(n,e),n};function ao(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!Gc(t))throw new Error("invalid output, must be aligned");return t}function uo(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const o=BigInt(32),s=BigInt(4294967295),i=Number(n>>o&s),c=Number(n&s),f=r?4:0,u=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+u,c,r)}function zc(e,t,n){mn(n);const r=new Uint8Array(16),o=Hc(r);return uo(o,0,BigInt(t),n),uo(o,8,BigInt(e),n),r}function Gc(e){return e.byteOffset%4===0}function En(e){return Uint8Array.from(e)}const lo=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),Yc=lo("expand 16-byte k"),Wc=lo("expand 32-byte k"),Xc=ke(Yc),Jc=ke(Wc);function q(e,t){return e<<t|e>>>32-t}function xn(e){return e.byteOffset%4===0}const jt=64,Qc=16,ho=2**32-1,po=new Uint32Array;function ef(e,t,n,r,o,s,i,c){const f=o.length,u=new Uint8Array(jt),a=ke(u),l=xn(o)&&xn(s),d=l?ke(o):po,h=l?ke(s):po;for(let y=0;y<f;i++){if(e(t,n,r,a,i,c),i>=ho)throw new Error("arx: counter overflow");const m=Math.min(jt,f-y);if(l&&m===jt){const v=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let R=0,Z;R<Qc;R++)Z=v+R,h[Z]=d[Z]^a[R];y+=jt;continue}for(let v=0,R;v<m;v++)R=y+v,s[R]=o[R]^u[v];y+=m}}function tf(e,t){const{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:s,rounds:i}=Kc({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return wn(o),wn(i),mn(s),mn(n),(c,f,u,a,l=0)=>{se(c),se(f),se(u);const d=u.length;if(a===void 0&&(a=new Uint8Array(d)),se(a),wn(l),l<0||l>=ho)throw new Error("arx: counter overflow");if(a.length<d)throw new Error(`arx: output (${a.length}) is shorter than data (${d})`);const h=[];let y=c.length,m,v;if(y===32)h.push(m=En(c)),v=Jc;else if(y===16&&n)m=new Uint8Array(32),m.set(c),m.set(c,16),v=Xc,h.push(m);else throw new Error(`arx: invalid 32-byte key, got length=${y}`);xn(f)||h.push(f=En(f));const R=ke(m);if(r){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(v,R,ke(f.subarray(0,16)),R),f=f.subarray(16)}const Z=16-o;if(Z!==f.length)throw new Error(`arx: nonce must be ${Z} or 16 bytes`);if(Z!==12){const z=new Uint8Array(12);z.set(f,s?0:12-f.length),f=z,h.push(f)}const _=ke(f);return ef(e,v,R,_,u,a,l,i),et(...h),a}}const X=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class nf{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=vn(t),se(t,32);const n=X(t,0),r=X(t,2),o=X(t,4),s=X(t,6),i=X(t,8),c=X(t,10),f=X(t,12),u=X(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|o<<6)&7939,this.r[3]=(o>>>7|s<<9)&8191,this.r[4]=(s>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|c<<2)&8191,this.r[7]=(c>>>11|f<<5)&8065,this.r[8]=(f>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let a=0;a<8;a++)this.pad[a]=X(t,16+2*a)}process(t,n,r=!1){const o=r?0:2048,{h:s,r:i}=this,c=i[0],f=i[1],u=i[2],a=i[3],l=i[4],d=i[5],h=i[6],y=i[7],m=i[8],v=i[9],R=X(t,n+0),Z=X(t,n+2),_=X(t,n+4),z=X(t,n+6),D=X(t,n+8),j=X(t,n+10),L=X(t,n+12),P=X(t,n+14);let O=s[0]+(R&8191),C=s[1]+((R>>>13|Z<<3)&8191),$=s[2]+((Z>>>10|_<<6)&8191),U=s[3]+((_>>>7|z<<9)&8191),p=s[4]+((z>>>4|D<<12)&8191),b=s[5]+(D>>>1&8191),g=s[6]+((D>>>14|j<<2)&8191),E=s[7]+((j>>>11|L<<5)&8191),x=s[8]+((L>>>8|P<<8)&8191),B=s[9]+(P>>>5|o),w=0,A=w+O*c+C*(5*v)+$*(5*m)+U*(5*y)+p*(5*h);w=A>>>13,A&=8191,A+=b*(5*d)+g*(5*l)+E*(5*a)+x*(5*u)+B*(5*f),w+=A>>>13,A&=8191;let S=w+O*f+C*c+$*(5*v)+U*(5*m)+p*(5*y);w=S>>>13,S&=8191,S+=b*(5*h)+g*(5*d)+E*(5*l)+x*(5*a)+B*(5*u),w+=S>>>13,S&=8191;let N=w+O*u+C*f+$*c+U*(5*v)+p*(5*m);w=N>>>13,N&=8191,N+=b*(5*y)+g*(5*h)+E*(5*d)+x*(5*l)+B*(5*a),w+=N>>>13,N&=8191;let V=w+O*a+C*u+$*f+U*c+p*(5*v);w=V>>>13,V&=8191,V+=b*(5*m)+g*(5*y)+E*(5*h)+x*(5*d)+B*(5*l),w+=V>>>13,V&=8191;let k=w+O*l+C*a+$*u+U*f+p*c;w=k>>>13,k&=8191,k+=b*(5*v)+g*(5*m)+E*(5*y)+x*(5*h)+B*(5*d),w+=k>>>13,k&=8191;let T=w+O*d+C*l+$*a+U*u+p*f;w=T>>>13,T&=8191,T+=b*c+g*(5*v)+E*(5*m)+x*(5*y)+B*(5*h),w+=T>>>13,T&=8191;let H=w+O*h+C*d+$*l+U*a+p*u;w=H>>>13,H&=8191,H+=b*f+g*c+E*(5*v)+x*(5*m)+B*(5*y),w+=H>>>13,H&=8191;let K=w+O*y+C*h+$*d+U*l+p*a;w=K>>>13,K&=8191,K+=b*u+g*f+E*c+x*(5*v)+B*(5*m),w+=K>>>13,K&=8191;let G=w+O*m+C*y+$*h+U*d+p*l;w=G>>>13,G&=8191,G+=b*a+g*u+E*f+x*c+B*(5*v),w+=G>>>13,G&=8191;let M=w+O*v+C*m+$*y+U*h+p*d;w=M>>>13,M&=8191,M+=b*l+g*a+E*u+x*f+B*c,w+=M>>>13,M&=8191,w=(w<<2)+w|0,w=w+A|0,A=w&8191,w=w>>>13,S+=w,s[0]=A,s[1]=S,s[2]=N,s[3]=V,s[4]=k,s[5]=T,s[6]=H,s[7]=K,s[8]=G,s[9]=M}finalize(){const{h:t,pad:n}=this,r=new Uint16Array(10);let o=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=o,o=t[c]>>>13,t[c]&=8191;t[0]+=o*5,o=t[0]>>>13,t[0]&=8191,t[1]+=o,o=t[1]>>>13,t[1]&=8191,t[2]+=o,r[0]=t[0]+5,o=r[0]>>>13,r[0]&=8191;for(let c=1;c<10;c++)r[c]=t[c]+o,o=r[c]>>>13,r[c]&=8191;r[9]-=8192;let s=(o^1)-1;for(let c=0;c<10;c++)r[c]&=s;s=~s;for(let c=0;c<10;c++)t[c]=t[c]&s|r[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+n[0];t[0]=i&65535;for(let c=1;c<8;c++)i=(t[c]+n[c]|0)+(i>>>16)|0,t[c]=i&65535;et(r)}update(t){fo(this),t=vn(t),se(t);const{buffer:n,blockLen:r}=this,o=t.length;for(let s=0;s<o;){const i=Math.min(r-this.pos,o-s);if(i===r){for(;r<=o-s;s+=r)this.process(t,s);continue}n.set(t.subarray(s,s+i),this.pos),this.pos+=i,s+=i,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){et(this.h,this.r,this.buffer,this.pad)}digestInto(t){fo(this),Vc(t,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:o}=this;if(o){for(n[o++]=1;o<16;o++)n[o]=0;this.process(n,0,!0)}this.finalize();let s=0;for(let i=0;i<8;i++)t[s++]=r[i]>>>0,t[s++]=r[i]>>>8;return t}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}}function rf(e){const t=(r,o)=>e(o).update(vn(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}const of=rf(e=>new nf(e));function sf(e,t,n,r,o,s=20){let i=e[0],c=e[1],f=e[2],u=e[3],a=t[0],l=t[1],d=t[2],h=t[3],y=t[4],m=t[5],v=t[6],R=t[7],Z=o,_=n[0],z=n[1],D=n[2],j=i,L=c,P=f,O=u,C=a,$=l,U=d,p=h,b=y,g=m,E=v,x=R,B=Z,w=_,A=z,S=D;for(let V=0;V<s;V+=2)j=j+C|0,B=q(B^j,16),b=b+B|0,C=q(C^b,12),j=j+C|0,B=q(B^j,8),b=b+B|0,C=q(C^b,7),L=L+$|0,w=q(w^L,16),g=g+w|0,$=q($^g,12),L=L+$|0,w=q(w^L,8),g=g+w|0,$=q($^g,7),P=P+U|0,A=q(A^P,16),E=E+A|0,U=q(U^E,12),P=P+U|0,A=q(A^P,8),E=E+A|0,U=q(U^E,7),O=O+p|0,S=q(S^O,16),x=x+S|0,p=q(p^x,12),O=O+p|0,S=q(S^O,8),x=x+S|0,p=q(p^x,7),j=j+$|0,S=q(S^j,16),E=E+S|0,$=q($^E,12),j=j+$|0,S=q(S^j,8),E=E+S|0,$=q($^E,7),L=L+U|0,B=q(B^L,16),x=x+B|0,U=q(U^x,12),L=L+U|0,B=q(B^L,8),x=x+B|0,U=q(U^x,7),P=P+p|0,w=q(w^P,16),b=b+w|0,p=q(p^b,12),P=P+p|0,w=q(w^P,8),b=b+w|0,p=q(p^b,7),O=O+C|0,A=q(A^O,16),g=g+A|0,C=q(C^g,12),O=O+C|0,A=q(A^O,8),g=g+A|0,C=q(C^g,7);let N=0;r[N++]=i+j|0,r[N++]=c+L|0,r[N++]=f+P|0,r[N++]=u+O|0,r[N++]=a+C|0,r[N++]=l+$|0,r[N++]=d+U|0,r[N++]=h+p|0,r[N++]=y+b|0,r[N++]=m+g|0,r[N++]=v+E|0,r[N++]=R+x|0,r[N++]=Z+B|0,r[N++]=_+w|0,r[N++]=z+A|0,r[N++]=D+S|0}const cf=tf(sf,{counterRight:!1,counterLength:4,allowShortKeys:!1}),ff=new Uint8Array(16),go=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(ff.subarray(n))},af=new Uint8Array(32);function bo(e,t,n,r,o){const s=e(t,n,af),i=of.create(s);o&&go(i,o),go(i,r);const c=zc(r.length,o?o.length:0,!0);i.update(c);const f=i.digest();return et(s,c),f}const uf=e=>(t,n,r)=>({encrypt(s,i){const c=s.length;i=ao(c+16,i,!1),i.set(s);const f=i.subarray(0,-16);e(t,n,f,f,1);const u=bo(e,t,n,f,r);return i.set(u,c),et(u),i},decrypt(s,i){i=ao(s.length-16,i,!1);const c=s.subarray(0,-16),f=s.subarray(-16),u=bo(e,t,n,c,r);if(!Fc(f,u))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),e(t,n,i,i,1),et(u),i}}),yo=Zc({blockSize:64,nonceLength:12,tagLength:16},uf(cf));class mo extends Ut{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Nt(t);const r=he(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,s=new Uint8Array(o);s.set(r.length>o?t.create().update(r).digest():r);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),ue(s)}update(t){return Ne(this),this.iHash.update(t),this}digestInto(t){Ne(this),de(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:i,outputLen:c}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Lt=(e,t,n)=>new mo(e,t).update(n).digest();Lt.create=(e,t)=>new mo(e,t);function lf(e,t,n){return Nt(e),n===void 0&&(n=new Uint8Array(e.outputLen)),Lt(e,he(n),he(t))}const An=Uint8Array.from([0]),wo=Uint8Array.of();function df(e,t,n,r=32){Nt(e),me(r);const o=e.outputLen;if(r>255*o)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(r/o);n===void 0&&(n=wo);const i=new Uint8Array(s*o),c=Lt.create(e,t),f=c._cloneInto(),u=new Uint8Array(c.outputLen);for(let a=0;a<s;a++)An[0]=a+1,f.update(a===0?wo:u).update(n).update(An).digestInto(u),i.set(u,o*a),c._cloneInto(f);return c.destroy(),f.destroy(),ue(u,An),i.slice(0,r)}const hf=(e,t,n,r,o)=>df(e,lf(e,t,n),r,o),Pt=_t,Bn=BigInt(0),Sn=BigInt(1);function kt(e,t=""){if(typeof e!="boolean"){const n=t&&`"${t}"`;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function qe(e,t,n=""){const r=Ot(e),o=e?.length,s=t!==void 0;if(!r||s&&o!==t){const i=n&&`"${n}" `,c=s?` of length ${t}`:"",f=r?`length=${o}`:`type=${typeof e}`;throw new Error(i+"expected Uint8Array"+c+", got "+f)}return e}function Dt(e){const t=e.toString(16);return t.length&1?"0"+t:t}function vo(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Bn:BigInt("0x"+e)}function Vt(e){return vo(Qe(e))}function Ht(e){return de(e),vo(Qe(Uint8Array.from(e).reverse()))}function In(e,t){return Rt(e.toString(16).padStart(t*2,"0"))}function On(e,t){return In(e,t).reverse()}function te(e,t,n){let r;if(typeof t=="string")try{r=Rt(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(Ot(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const o=r.length;if(typeof n=="number"&&o!==n)throw new Error(e+" of length "+n+" expected, got "+o);return r}const Nn=e=>typeof e=="bigint"&&Bn<=e;function pf(e,t,n){return Nn(e)&&Nn(t)&&Nn(n)&&t<=e&&e<n}function Rn(e,t,n,r){if(!pf(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function Eo(e){let t;for(t=0;e>Bn;e>>=Sn,t+=1);return t}const bt=e=>(Sn<<BigInt(e))-Sn;function gf(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),o=h=>Uint8Array.of(h);let s=r(e),i=r(e),c=0;const f=()=>{s.fill(1),i.fill(0),c=0},u=(...h)=>n(i,s,...h),a=(h=r(0))=>{i=u(o(0),h),s=u(),h.length!==0&&(i=u(o(1),h),s=u())},l=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const y=[];for(;h<t;){s=u();const m=s.slice();y.push(m),h+=s.length}return Ue(...y)};return(h,y)=>{f(),a(h);let m;for(;!(m=y(l()));)a();return f(),m}}function Mt(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(o,s,i){const c=e[o];if(i&&c===void 0)return;const f=typeof c;if(f!==s||c===null)throw new Error(`param "${o}" is invalid: expected ${s}, got ${f}`)}Object.entries(t).forEach(([o,s])=>r(o,s,!1)),Object.entries(n).forEach(([o,s])=>r(o,s,!0))}function xo(e){const t=new WeakMap;return(n,...r)=>{const o=t.get(n);if(o!==void 0)return o;const s=e(n,...r);return t.set(n,s),s}}const ie=BigInt(0),re=BigInt(1),Ke=BigInt(2),Ao=BigInt(3),Bo=BigInt(4),So=BigInt(5),bf=BigInt(7),Io=BigInt(8),yf=BigInt(9),Oo=BigInt(16);function ce(e,t){const n=e%t;return n>=ie?n:t+n}function pe(e,t,n){let r=e;for(;t-- >ie;)r*=r,r%=n;return r}function No(e,t){if(e===ie)throw new Error("invert: expected non-zero number");if(t<=ie)throw new Error("invert: expected positive modulus, got "+t);let n=ce(e,t),r=t,o=ie,s=re;for(;n!==ie;){const c=r/n,f=r%n,u=o-s*c;r=n,n=f,o=s,s=u}if(r!==re)throw new Error("invert: does not exist");return ce(o,t)}function Un(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function Ro(e,t){const n=(e.ORDER+re)/Bo,r=e.pow(t,n);return Un(e,r,t),r}function mf(e,t){const n=(e.ORDER-So)/Io,r=e.mul(t,Ke),o=e.pow(r,n),s=e.mul(t,o),i=e.mul(e.mul(s,Ke),o),c=e.mul(s,e.sub(i,e.ONE));return Un(e,c,t),c}function wf(e){const t=De(e),n=Uo(e),r=n(t,t.neg(t.ONE)),o=n(t,r),s=n(t,t.neg(r)),i=(e+bf)/Oo;return(c,f)=>{let u=c.pow(f,i),a=c.mul(u,r);const l=c.mul(u,o),d=c.mul(u,s),h=c.eql(c.sqr(a),f),y=c.eql(c.sqr(l),f);u=c.cmov(u,a,h),a=c.cmov(d,l,y);const m=c.eql(c.sqr(a),f),v=c.cmov(u,a,m);return Un(c,v,f),v}}function Uo(e){if(e<Ao)throw new Error("sqrt is not defined for small field");let t=e-re,n=0;for(;t%Ke===ie;)t/=Ke,n++;let r=Ke;const o=De(e);for(;To(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return Ro;let s=o.pow(r,t);const i=(t+re)/Ke;return function(f,u){if(f.is0(u))return u;if(To(f,u)!==1)throw new Error("Cannot find square root");let a=n,l=f.mul(f.ONE,s),d=f.pow(u,t),h=f.pow(u,i);for(;!f.eql(d,f.ONE);){if(f.is0(d))return f.ZERO;let y=1,m=f.sqr(d);for(;!f.eql(m,f.ONE);)if(y++,m=f.sqr(m),y===a)throw new Error("Cannot find square root");const v=re<<BigInt(a-y-1),R=f.pow(l,v);a=y,l=f.sqr(R),d=f.mul(d,l),h=f.mul(h,R)}return h}}function vf(e){return e%Bo===Ao?Ro:e%Io===So?mf:e%Oo===yf?wf(e):Uo(e)}const Ef=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function xf(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=Ef.reduce((r,o)=>(r[o]="function",r),t);return Mt(e,n),e}function Af(e,t,n){if(n<ie)throw new Error("invalid exponent, negatives unsupported");if(n===ie)return e.ONE;if(n===re)return t;let r=e.ONE,o=t;for(;n>ie;)n&re&&(r=e.mul(r,o)),o=e.sqr(o),n>>=re;return r}function _o(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),o=t.reduce((i,c,f)=>e.is0(c)?i:(r[f]=i,e.mul(i,c)),e.ONE),s=e.inv(o);return t.reduceRight((i,c,f)=>e.is0(c)?i:(r[f]=e.mul(i,r[f]),e.mul(i,c)),s),r}function To(e,t){const n=(e.ORDER-re)/Ke,r=e.pow(t,n),o=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),i=e.eql(r,e.neg(e.ONE));if(!o&&!s&&!i)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}function Co(e,t){t!==void 0&&me(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function De(e,t,n=!1,r={}){if(e<=ie)throw new Error("invalid field: expected ORDER > 0, got "+e);let o,s,i=!1,c;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const d=t;d.BITS&&(o=d.BITS),d.sqrt&&(s=d.sqrt),typeof d.isLE=="boolean"&&(n=d.isLE),typeof d.modFromBytes=="boolean"&&(i=d.modFromBytes),c=d.allowedLengths}else typeof t=="number"&&(o=t),r.sqrt&&(s=r.sqrt);const{nBitLength:f,nByteLength:u}=Co(e,o);if(u>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let a;const l=Object.freeze({ORDER:e,isLE:n,BITS:f,BYTES:u,MASK:bt(f),ZERO:ie,ONE:re,allowedLengths:c,create:d=>ce(d,e),isValid:d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return ie<=d&&d<e},is0:d=>d===ie,isValidNot0:d=>!l.is0(d)&&l.isValid(d),isOdd:d=>(d&re)===re,neg:d=>ce(-d,e),eql:(d,h)=>d===h,sqr:d=>ce(d*d,e),add:(d,h)=>ce(d+h,e),sub:(d,h)=>ce(d-h,e),mul:(d,h)=>ce(d*h,e),pow:(d,h)=>Af(l,d,h),div:(d,h)=>ce(d*No(h,e),e),sqrN:d=>d*d,addN:(d,h)=>d+h,subN:(d,h)=>d-h,mulN:(d,h)=>d*h,inv:d=>No(d,e),sqrt:s||(d=>(a||(a=vf(e)),a(l,d))),toBytes:d=>n?On(d,u):In(d,u),fromBytes:(d,h=!0)=>{if(c){if(!c.includes(d.length)||d.length>u)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+d.length);const m=new Uint8Array(u);m.set(d,n?0:m.length-d.length),d=m}if(d.length!==u)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+d.length);let y=n?Ht(d):Vt(d);if(i&&(y=ce(y,e)),!h&&!l.isValid(y))throw new Error("invalid field element: outside of range 0..ORDER");return y},invertBatch:d=>_o(l,d),cmov:(d,h,y)=>y?h:d});return Object.freeze(l)}function $o(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function jo(e){const t=$o(e);return t+Math.ceil(t/2)}function Bf(e,t,n=!1){const r=e.length,o=$o(t),s=jo(t);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);const i=n?Ht(e):Vt(e),c=ce(i,t-re)+re;return n?On(c,o):In(c,o)}const tt=BigInt(0),Fe=BigInt(1);function qt(e,t){const n=t.negate();return e?n:t}function _n(e,t){const n=_o(e.Fp,t.map(r=>r.Z));return t.map((r,o)=>e.fromAffine(r.toAffine(n[o])))}function Lo(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Tn(e,t){Lo(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),o=2**e,s=bt(e),i=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:o,shiftBy:i}}function Po(e,t,n){const{windowSize:r,mask:o,maxNumber:s,shiftBy:i}=n;let c=Number(e&o),f=e>>i;c>r&&(c-=s,f+=Fe);const u=t*r,a=u+Math.abs(c)-1,l=c===0,d=c<0,h=t%2!==0;return{nextN:f,offset:a,isZero:l,isNeg:d,isNegF:h,offsetF:u}}function Sf(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function If(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const Cn=new WeakMap,ko=new WeakMap;function $n(e){return ko.get(e)||1}function Do(e){if(e!==tt)throw new Error("invalid wNAF")}class Of{constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let o=t;for(;n>tt;)n&Fe&&(r=r.add(o)),o=o.double(),n>>=Fe;return r}precomputeWindow(t,n){const{windows:r,windowSize:o}=Tn(n,this.bits),s=[];let i=t,c=i;for(let f=0;f<r;f++){c=i,s.push(c);for(let u=1;u<o;u++)c=c.add(i),s.push(c);i=c.double()}return s}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,s=this.BASE;const i=Tn(t,this.bits);for(let c=0;c<i.windows;c++){const{nextN:f,offset:u,isZero:a,isNeg:l,isNegF:d,offsetF:h}=Po(r,c,i);r=f,a?s=s.add(qt(d,n[h])):o=o.add(qt(l,n[u]))}return Do(r),{p:o,f:s}}wNAFUnsafe(t,n,r,o=this.ZERO){const s=Tn(t,this.bits);for(let i=0;i<s.windows&&r!==tt;i++){const{nextN:c,offset:f,isZero:u,isNeg:a}=Po(r,i,s);if(r=c,!u){const l=n[f];o=o.add(a?l.negate():l)}}return Do(r),o}getPrecomputes(t,n,r){let o=Cn.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(o=r(o)),Cn.set(n,o))),o}cached(t,n,r){const o=$n(t);return this.wNAF(o,this.getPrecomputes(o,t,r),n)}unsafe(t,n,r,o){const s=$n(t);return s===1?this._unsafeLadder(t,n,o):this.wNAFUnsafe(s,this.getPrecomputes(s,t,r),n,o)}createCache(t,n){Lo(n,this.bits),ko.set(t,n),Cn.delete(t)}hasCache(t){return $n(t)!==1}}function Nf(e,t,n,r){let o=t,s=e.ZERO,i=e.ZERO;for(;n>tt||r>tt;)n&Fe&&(s=s.add(o)),r&Fe&&(i=i.add(o)),o=o.double(),n>>=Fe,r>>=Fe;return{p1:s,p2:i}}function Rf(e,t,n,r){Sf(n,e),If(r,t);const o=n.length,s=r.length;if(o!==s)throw new Error("arrays of points and scalars must have equal length");const i=e.ZERO,c=Eo(BigInt(o));let f=1;c>12?f=c-3:c>4?f=c-2:c>0&&(f=2);const u=bt(f),a=new Array(Number(u)+1).fill(i),l=Math.floor((t.BITS-1)/f)*f;let d=i;for(let h=l;h>=0;h-=f){a.fill(i);for(let m=0;m<s;m++){const v=r[m],R=Number(v>>BigInt(h)&u);a[R]=a[R].add(n[m])}let y=i;for(let m=a.length-1,v=i;m>0;m--)v=v.add(a[m]),y=y.add(v);if(d=d.add(y),h!==0)for(let m=0;m<f;m++)d=d.double()}return d}function Vo(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return xf(t),t}else return De(e,{isLE:n})}function Uf(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const f of["p","n","h"]){const u=t[f];if(!(typeof u=="bigint"&&u>tt))throw new Error(`CURVE.${f} must be positive bigint`)}const o=Vo(t.p,n.Fp,r),s=Vo(t.n,n.Fn,r),c=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(const f of c)if(!o.isValid(t[f]))throw new Error(`CURVE.${f} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8),Cr("HashToScalar-");const yt=BigInt(0),nt=BigInt(1),Kt=BigInt(2);function _f(e){return Mt(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}function Tf(e){const t=_f(e),{P:n,type:r,adjustScalarBytes:o,powPminus2:s,randomBytes:i}=t,c=r==="x25519";if(!c&&r!=="x448")throw new Error("invalid type");const f=i||Me,u=c?255:448,a=c?32:56,l=BigInt(c?9:5),d=BigInt(c?121665:39081),h=c?Kt**BigInt(254):Kt**BigInt(447),y=c?BigInt(8)*Kt**BigInt(251)-nt:BigInt(4)*Kt**BigInt(445)-nt,m=h+y+nt,v=p=>ce(p,n),R=Z(l);function Z(p){return On(v(p),a)}function _(p){const b=te("u coordinate",p,a);return c&&(b[31]&=127),v(Ht(b))}function z(p){return Ht(o(te("scalar",p,a)))}function D(p,b){const g=P(_(b),z(p));if(g===yt)throw new Error("invalid private or public key received");return Z(g)}function j(p){return D(p,R)}function L(p,b,g){const E=v(p*(b-g));return b=v(b-E),g=v(g+E),{x_2:b,x_3:g}}function P(p,b){Rn("u",p,yt,n),Rn("scalar",b,h,m);const g=b,E=p;let x=nt,B=yt,w=p,A=nt,S=yt;for(let V=BigInt(u-1);V>=yt;V--){const k=g>>V&nt;S^=k,{x_2:x,x_3:w}=L(S,x,w),{x_2:B,x_3:A}=L(S,B,A),S=k;const T=x+B,H=v(T*T),K=x-B,G=v(K*K),M=H-G,W=w+A,Ye=w-A,ft=v(Ye*T),at=v(W*K),Xn=ft+at,Jn=ft-at;w=v(Xn*Xn),A=v(E*v(Jn*Jn)),x=v(H*G),B=v(M*(H+v(d*M)))}({x_2:x,x_3:w}=L(S,x,w)),{x_2:B,x_3:A}=L(S,B,A);const N=s(B);return v(x*N)}const O={secretKey:a,publicKey:a,seed:a},C=(p=f(a))=>(de(p,O.seed),p);function $(p){const b=C(p);return{secretKey:b,publicKey:j(b)}}return{keygen:$,getSharedSecret:(p,b)=>D(p,b),getPublicKey:p=>j(p),scalarMult:D,scalarMultBase:j,utils:{randomSecretKey:C,randomPrivateKey:C},GuBytes:R.slice(),lengths:O}}const Cf=BigInt(1),Ho=BigInt(2),$f=BigInt(3),jf=BigInt(5),Lf=BigInt(8),Mo=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Pf={p:Mo,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Lf,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function kf(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),s=Mo,c=e*e%s*e%s,f=pe(c,Ho,s)*c%s,u=pe(f,Cf,s)*e%s,a=pe(u,jf,s)*u%s,l=pe(a,t,s)*a%s,d=pe(l,n,s)*l%s,h=pe(d,r,s)*d%s,y=pe(h,o,s)*h%s,m=pe(y,o,s)*h%s,v=pe(m,t,s)*a%s;return{pow_p_5_8:pe(v,Ho,s)*e%s,b2:c}}function Df(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const Vf=De(Pf.p,{isLE:!0}),jn=(()=>{const e=Vf.ORDER;return Tf({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:n,b2:r}=kf(t);return ce(pe(n,$f,e)*r,e)},adjustScalarBytes:Df})})(),qo=(e,t)=>(e+(e>=0?t:-t)/Ko)/t;function Hf(e,t,n){const[[r,o],[s,i]]=t,c=qo(i*e,n),f=qo(-o*e,n);let u=e-c*r-f*s,a=-c*o-f*i;const l=u<xe,d=a<xe;l&&(u=-u),d&&(a=-a);const h=bt(Math.ceil(Eo(n)/2))+rt;if(u<xe||u>=h||a<xe||a>=h)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:l,k1:u,k2neg:d,k2:a}}function Ln(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function Pn(e,t){const n={};for(let r of Object.keys(t))n[r]=e[r]===void 0?t[r]:e[r];return kt(n.lowS,"lowS"),kt(n.prehash,"prehash"),n.format!==void 0&&Ln(n.format),n}class Mf extends Error{constructor(t=""){super(t)}}const Ee={Err:Mf,_tlv:{encode:(e,t)=>{const{Err:n}=Ee;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,o=Dt(r);if(o.length/2&128)throw new n("tlv.encode: long form length too big");const s=r>127?Dt(o.length/2|128):"";return Dt(e)+s+o+t},decode(e,t){const{Err:n}=Ee;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const o=t[r++],s=!!(o&128);let i=0;if(!s)i=o;else{const f=o&127;if(!f)throw new n("tlv.decode(long): indefinite length not supported");if(f>4)throw new n("tlv.decode(long): byte length is too big");const u=t.subarray(r,r+f);if(u.length!==f)throw new n("tlv.decode: length bytes not complete");if(u[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const a of u)i=i<<8|a;if(r+=f,i<128)throw new n("tlv.decode(long): not minimal encoding")}const c=t.subarray(r,r+i);if(c.length!==i)throw new n("tlv.decode: wrong value length");return{v:c,l:t.subarray(r+i)}}},_int:{encode(e){const{Err:t}=Ee;if(e<xe)throw new t("integer: negative integers are not allowed");let n=Dt(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=Ee;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Vt(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=Ee,o=te("signature",e),{v:s,l:i}=r.decode(48,o);if(i.length)throw new t("invalid signature: left bytes after parsing");const{v:c,l:f}=r.decode(2,s),{v:u,l:a}=r.decode(2,f);if(a.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(u)}},hexFromSig(e){const{_tlv:t,_int:n}=Ee,r=t.encode(2,n.encode(e.r)),o=t.encode(2,n.encode(e.s)),s=r+o;return t.encode(48,s)}},xe=BigInt(0),rt=BigInt(1),Ko=BigInt(2),Ft=BigInt(3),qf=BigInt(4);function ot(e,t){const{BYTES:n}=e;let r;if(typeof t=="bigint")r=t;else{let o=te("private key",t);try{r=e.fromBytes(o)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function Kf(e,t={}){const n=Uf("weierstrass",e,t),{Fp:r,Fn:o}=n;let s=n.CURVE;const{h:i,n:c}=s;Mt(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:f}=t;if(f&&(!r.is0(s.a)||typeof f.beta!="bigint"||!Array.isArray(f.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const u=Zo(r,o);function a(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function l(U,p,b){const{x:g,y:E}=p.toAffine(),x=r.toBytes(g);if(kt(b,"isCompressed"),b){a();const B=!r.isOdd(E);return Ue(Fo(B),x)}else return Ue(Uint8Array.of(4),x,r.toBytes(E))}function d(U){qe(U,void 0,"Point");const{publicKey:p,publicKeyUncompressed:b}=u,g=U.length,E=U[0],x=U.subarray(1);if(g===p&&(E===2||E===3)){const B=r.fromBytes(x);if(!r.isValid(B))throw new Error("bad point: is not on curve, wrong x");const w=m(B);let A;try{A=r.sqrt(w)}catch(V){const k=V instanceof Error?": "+V.message:"";throw new Error("bad point: is not on curve, sqrt error"+k)}a();const S=r.isOdd(A);return(E&1)===1!==S&&(A=r.neg(A)),{x:B,y:A}}else if(g===b&&E===4){const B=r.BYTES,w=r.fromBytes(x.subarray(0,B)),A=r.fromBytes(x.subarray(B,B*2));if(!v(w,A))throw new Error("bad point: is not on curve");return{x:w,y:A}}else throw new Error(`bad point: got length ${g}, expected compressed=${p} or uncompressed=${b}`)}const h=t.toBytes||l,y=t.fromBytes||d;function m(U){const p=r.sqr(U),b=r.mul(p,U);return r.add(r.add(b,r.mul(U,s.a)),s.b)}function v(U,p){const b=r.sqr(p),g=m(U);return r.eql(b,g)}if(!v(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const R=r.mul(r.pow(s.a,Ft),qf),Z=r.mul(r.sqr(s.b),BigInt(27));if(r.is0(r.add(R,Z)))throw new Error("bad curve params: a or b");function _(U,p,b=!1){if(!r.isValid(p)||b&&r.is0(p))throw new Error(`bad point coordinate ${U}`);return p}function z(U){if(!(U instanceof O))throw new Error("ProjectivePoint expected")}function D(U){if(!f||!f.basises)throw new Error("no endo");return Hf(U,f.basises,o.ORDER)}const j=xo((U,p)=>{const{X:b,Y:g,Z:E}=U;if(r.eql(E,r.ONE))return{x:b,y:g};const x=U.is0();p==null&&(p=x?r.ONE:r.inv(E));const B=r.mul(b,p),w=r.mul(g,p),A=r.mul(E,p);if(x)return{x:r.ZERO,y:r.ZERO};if(!r.eql(A,r.ONE))throw new Error("invZ was invalid");return{x:B,y:w}}),L=xo(U=>{if(U.is0()){if(t.allowInfinityPoint&&!r.is0(U.Y))return;throw new Error("bad point: ZERO")}const{x:p,y:b}=U.toAffine();if(!r.isValid(p)||!r.isValid(b))throw new Error("bad point: x or y not field elements");if(!v(p,b))throw new Error("bad point: equation left != right");if(!U.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function P(U,p,b,g,E){return b=new O(r.mul(b.X,U),b.Y,b.Z),p=qt(g,p),b=qt(E,b),p.add(b)}class O{constructor(p,b,g){this.X=_("x",p),this.Y=_("y",b,!0),this.Z=_("z",g),Object.freeze(this)}static CURVE(){return s}static fromAffine(p){const{x:b,y:g}=p||{};if(!p||!r.isValid(b)||!r.isValid(g))throw new Error("invalid affine point");if(p instanceof O)throw new Error("projective point not allowed");return r.is0(b)&&r.is0(g)?O.ZERO:new O(b,g,r.ONE)}static fromBytes(p){const b=O.fromAffine(y(qe(p,void 0,"point")));return b.assertValidity(),b}static fromHex(p){return O.fromBytes(te("pointHex",p))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(p=8,b=!0){return $.createCache(this,p),b||this.multiply(Ft),this}assertValidity(){L(this)}hasEvenY(){const{y:p}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(p)}equals(p){z(p);const{X:b,Y:g,Z:E}=this,{X:x,Y:B,Z:w}=p,A=r.eql(r.mul(b,w),r.mul(x,E)),S=r.eql(r.mul(g,w),r.mul(B,E));return A&&S}negate(){return new O(this.X,r.neg(this.Y),this.Z)}double(){const{a:p,b}=s,g=r.mul(b,Ft),{X:E,Y:x,Z:B}=this;let w=r.ZERO,A=r.ZERO,S=r.ZERO,N=r.mul(E,E),V=r.mul(x,x),k=r.mul(B,B),T=r.mul(E,x);return T=r.add(T,T),S=r.mul(E,B),S=r.add(S,S),w=r.mul(p,S),A=r.mul(g,k),A=r.add(w,A),w=r.sub(V,A),A=r.add(V,A),A=r.mul(w,A),w=r.mul(T,w),S=r.mul(g,S),k=r.mul(p,k),T=r.sub(N,k),T=r.mul(p,T),T=r.add(T,S),S=r.add(N,N),N=r.add(S,N),N=r.add(N,k),N=r.mul(N,T),A=r.add(A,N),k=r.mul(x,B),k=r.add(k,k),N=r.mul(k,T),w=r.sub(w,N),S=r.mul(k,V),S=r.add(S,S),S=r.add(S,S),new O(w,A,S)}add(p){z(p);const{X:b,Y:g,Z:E}=this,{X:x,Y:B,Z:w}=p;let A=r.ZERO,S=r.ZERO,N=r.ZERO;const V=s.a,k=r.mul(s.b,Ft);let T=r.mul(b,x),H=r.mul(g,B),K=r.mul(E,w),G=r.add(b,g),M=r.add(x,B);G=r.mul(G,M),M=r.add(T,H),G=r.sub(G,M),M=r.add(b,E);let W=r.add(x,w);return M=r.mul(M,W),W=r.add(T,K),M=r.sub(M,W),W=r.add(g,E),A=r.add(B,w),W=r.mul(W,A),A=r.add(H,K),W=r.sub(W,A),N=r.mul(V,M),A=r.mul(k,K),N=r.add(A,N),A=r.sub(H,N),N=r.add(H,N),S=r.mul(A,N),H=r.add(T,T),H=r.add(H,T),K=r.mul(V,K),M=r.mul(k,M),H=r.add(H,K),K=r.sub(T,K),K=r.mul(V,K),M=r.add(M,K),T=r.mul(H,M),S=r.add(S,T),T=r.mul(W,M),A=r.mul(G,A),A=r.sub(A,T),T=r.mul(G,H),N=r.mul(W,N),N=r.add(N,T),new O(A,S,N)}subtract(p){return this.add(p.negate())}is0(){return this.equals(O.ZERO)}multiply(p){const{endo:b}=t;if(!o.isValidNot0(p))throw new Error("invalid scalar: out of range");let g,E;const x=B=>$.cached(this,B,w=>_n(O,w));if(b){const{k1neg:B,k1:w,k2neg:A,k2:S}=D(p),{p:N,f:V}=x(w),{p:k,f:T}=x(S);E=V.add(T),g=P(b.beta,N,k,B,A)}else{const{p:B,f:w}=x(p);g=B,E=w}return _n(O,[g,E])[0]}multiplyUnsafe(p){const{endo:b}=t,g=this;if(!o.isValid(p))throw new Error("invalid scalar: out of range");if(p===xe||g.is0())return O.ZERO;if(p===rt)return g;if($.hasCache(this))return this.multiply(p);if(b){const{k1neg:E,k1:x,k2neg:B,k2:w}=D(p),{p1:A,p2:S}=Nf(O,g,x,w);return P(b.beta,A,S,E,B)}else return $.unsafe(g,p)}multiplyAndAddUnsafe(p,b,g){const E=this.multiplyUnsafe(b).add(p.multiplyUnsafe(g));return E.is0()?void 0:E}toAffine(p){return j(this,p)}isTorsionFree(){const{isTorsionFree:p}=t;return i===rt?!0:p?p(O,this):$.unsafe(this,c).is0()}clearCofactor(){const{clearCofactor:p}=t;return i===rt?this:p?p(O,this):this.multiplyUnsafe(i)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}toBytes(p=!0){return kt(p,"isCompressed"),this.assertValidity(),h(O,this,p)}toHex(p=!0){return Qe(this.toBytes(p))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(p=!0){return this.toBytes(p)}_setWindowSize(p){this.precompute(p)}static normalizeZ(p){return _n(O,p)}static msm(p,b){return Rf(O,o,p,b)}static fromPrivateKey(p){return O.BASE.multiply(ot(o,p))}}O.BASE=new O(s.Gx,s.Gy,r.ONE),O.ZERO=new O(r.ZERO,r.ONE,r.ZERO),O.Fp=r,O.Fn=o;const C=o.BITS,$=new Of(O,t.endo?Math.ceil(C/2):C);return O.BASE.precompute(8),O}function Fo(e){return Uint8Array.of(e?2:3)}function Zo(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function Ff(e,t={}){const{Fn:n}=e,r=t.randomBytes||Me,o=Object.assign(Zo(e.Fp,n),{seed:jo(n.ORDER)});function s(h){try{return!!ot(n,h)}catch{return!1}}function i(h,y){const{publicKey:m,publicKeyUncompressed:v}=o;try{const R=h.length;return y===!0&&R!==m||y===!1&&R!==v?!1:!!e.fromBytes(h)}catch{return!1}}function c(h=r(o.seed)){return Bf(qe(h,o.seed,"seed"),n.ORDER)}function f(h,y=!0){return e.BASE.multiply(ot(n,h)).toBytes(y)}function u(h){const y=c(h);return{secretKey:y,publicKey:f(y)}}function a(h){if(typeof h=="bigint")return!1;if(h instanceof e)return!0;const{secretKey:y,publicKey:m,publicKeyUncompressed:v}=o;if(n.allowedLengths||y===m)return;const R=te("key",h).length;return R===m||R===v}function l(h,y,m=!0){if(a(h)===!0)throw new Error("first arg must be private key");if(a(y)===!1)throw new Error("second arg must be public key");const v=ot(n,h);return e.fromHex(y).multiply(v).toBytes(m)}return Object.freeze({getPublicKey:f,getSharedSecret:l,keygen:u,Point:e,utils:{isValidSecretKey:s,isValidPublicKey:i,randomSecretKey:c,isValidPrivateKey:s,randomPrivateKey:c,normPrivateKeyToScalar:h=>ot(n,h),precompute(h=8,y=e.BASE){return y.precompute(h,!1)}},lengths:o})}function Zf(e,t,n={}){Nt(t),Mt(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=n.randomBytes||Me,o=n.hmac||((b,...g)=>Lt(t,b,Ue(...g))),{Fp:s,Fn:i}=e,{ORDER:c,BITS:f}=i,{keygen:u,getPublicKey:a,getSharedSecret:l,utils:d,lengths:h}=Ff(e,n),y={prehash:!1,lowS:typeof n.lowS=="boolean"?n.lowS:!1,format:void 0,extraEntropy:!1},m="compact";function v(b){const g=c>>rt;return b>g}function R(b,g){if(!i.isValidNot0(g))throw new Error(`invalid signature ${b}: out of range 1..Point.Fn.ORDER`);return g}function Z(b,g){Ln(g);const E=h.signature,x=g==="compact"?E:g==="recovered"?E+1:void 0;return qe(b,x,`${g} signature`)}class _{constructor(g,E,x){this.r=R("r",g),this.s=R("s",E),x!=null&&(this.recovery=x),Object.freeze(this)}static fromBytes(g,E=m){Z(g,E);let x;if(E==="der"){const{r:S,s:N}=Ee.toSig(qe(g));return new _(S,N)}E==="recovered"&&(x=g[0],E="compact",g=g.subarray(1));const B=i.BYTES,w=g.subarray(0,B),A=g.subarray(B,B*2);return new _(i.fromBytes(w),i.fromBytes(A),x)}static fromHex(g,E){return this.fromBytes(Rt(g),E)}addRecoveryBit(g){return new _(this.r,this.s,g)}recoverPublicKey(g){const E=s.ORDER,{r:x,s:B,recovery:w}=this;if(w==null||![0,1,2,3].includes(w))throw new Error("recovery id invalid");if(c*Ko<E&&w>1)throw new Error("recovery id is ambiguous for h>1 curve");const S=w===2||w===3?x+c:x;if(!s.isValid(S))throw new Error("recovery id 2 or 3 invalid");const N=s.toBytes(S),V=e.fromBytes(Ue(Fo((w&1)===0),N)),k=i.inv(S),T=D(te("msgHash",g)),H=i.create(-T*k),K=i.create(B*k),G=e.BASE.multiplyUnsafe(H).add(V.multiplyUnsafe(K));if(G.is0())throw new Error("point at infinify");return G.assertValidity(),G}hasHighS(){return v(this.s)}toBytes(g=m){if(Ln(g),g==="der")return Rt(Ee.hexFromSig(this));const E=i.toBytes(this.r),x=i.toBytes(this.s);if(g==="recovered"){if(this.recovery==null)throw new Error("recovery bit must be present");return Ue(Uint8Array.of(this.recovery),E,x)}return Ue(E,x)}toHex(g){return Qe(this.toBytes(g))}assertValidity(){}static fromCompact(g){return _.fromBytes(te("sig",g),"compact")}static fromDER(g){return _.fromBytes(te("sig",g),"der")}normalizeS(){return this.hasHighS()?new _(this.r,i.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Qe(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Qe(this.toBytes("compact"))}}const z=n.bits2int||function(g){if(g.length>8192)throw new Error("input is too large");const E=Vt(g),x=g.length*8-f;return x>0?E>>BigInt(x):E},D=n.bits2int_modN||function(g){return i.create(z(g))},j=bt(f);function L(b){return Rn("num < 2^"+f,b,xe,j),i.toBytes(b)}function P(b,g){return qe(b,void 0,"message"),g?qe(t(b),void 0,"prehashed message"):b}function O(b,g,E){if(["recovered","canonical"].some(H=>H in E))throw new Error("sign() legacy options not supported");const{lowS:x,prehash:B,extraEntropy:w}=Pn(E,y);b=P(b,B);const A=D(b),S=ot(i,g),N=[L(S),L(A)];if(w!=null&&w!==!1){const H=w===!0?r(h.secretKey):w;N.push(te("extraEntropy",H))}const V=Ue(...N),k=A;function T(H){const K=z(H);if(!i.isValidNot0(K))return;const G=i.inv(K),M=e.BASE.multiply(K).toAffine(),W=i.create(M.x);if(W===xe)return;const Ye=i.create(G*i.create(k+W*S));if(Ye===xe)return;let ft=(M.x===W?0:2)|Number(M.y&rt),at=Ye;return x&&v(Ye)&&(at=i.neg(Ye),ft^=1),new _(W,at,ft)}return{seed:V,k2sig:T}}function C(b,g,E={}){b=te("message",b);const{seed:x,k2sig:B}=O(b,g,E);return gf(t.outputLen,i.BYTES,o)(x,B)}function $(b){let g;const E=typeof b=="string"||Ot(b),x=!E&&b!==null&&typeof b=="object"&&typeof b.r=="bigint"&&typeof b.s=="bigint";if(!E&&!x)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(x)g=new _(b.r,b.s);else if(E){try{g=_.fromBytes(te("sig",b),"der")}catch(B){if(!(B instanceof Ee.Err))throw B}if(!g)try{g=_.fromBytes(te("sig",b),"compact")}catch{return!1}}return g||!1}function U(b,g,E,x={}){const{lowS:B,prehash:w,format:A}=Pn(x,y);if(E=te("publicKey",E),g=P(te("message",g),w),"strict"in x)throw new Error("options.strict was renamed to lowS");const S=A===void 0?$(b):_.fromBytes(te("sig",b),A);if(S===!1)return!1;try{const N=e.fromBytes(E);if(B&&S.hasHighS())return!1;const{r:V,s:k}=S,T=D(g),H=i.inv(k),K=i.create(T*H),G=i.create(V*H),M=e.BASE.multiplyUnsafe(K).add(N.multiplyUnsafe(G));return M.is0()?!1:i.create(M.x)===V}catch{return!1}}function p(b,g,E={}){const{prehash:x}=Pn(E,y);return g=P(g,x),_.fromBytes(b,"recovered").recoverPublicKey(g).toBytes()}return Object.freeze({keygen:u,getPublicKey:a,getSharedSecret:l,utils:d,lengths:h,Point:e,sign:C,verify:U,recoverPublicKey:p,Signature:_,hash:t})}function zf(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp;let r=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(i=>Math.ceil(i/2)))):void 0;const o=De(t.n,{BITS:e.nBitLength,allowedLengths:r,modFromBytes:e.wrapPrivateKey}),s={Fp:n,Fn:o,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:s}}function Gf(e){const{CURVE:t,curveOpts:n}=zf(e),r={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,hash:e.hash,ecdsaOpts:r}}function Yf(e,t){const n=t.Point;return Object.assign({},t,{ProjectivePoint:n,CURVE:Object.assign({},e,Co(n.Fn.ORDER,n.Fn.BITS))})}function Wf(e){const{CURVE:t,curveOpts:n,hash:r,ecdsaOpts:o}=Gf(e),s=Kf(t,n),i=Zf(s,r,o);return Yf(e,i)}function kn(e,t){const n=r=>Wf({...e,hash:r});return{...n(t),create:n}}const zo={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Go={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Yo={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Xf=De(zo.p),Jf=De(Go.p),Qf=De(Yo.p),ea=kn({...zo,Fp:Xf,lowS:!1},_t);kn({...Go,Fp:Jf,lowS:!1},uc),kn({...Yo,Fp:Qf,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},ac);const ta=ea,Dn="base10",oe="base16",st="base64pad",Zt="base64url",it="utf8",Vn=0,ct=1,mt=2,na=0,Wo=1,wt=12,Hn=32;function ra(){const e=jn.utils.randomPrivateKey(),t=jn.getPublicKey(e);return{privateKey:F.toString(e,oe),publicKey:F.toString(t,oe)}}function oa(){const e=Me(Hn);return F.toString(e,oe)}function sa(e,t){const n=jn.getSharedSecret(F.fromString(e,oe),F.fromString(t,oe)),r=hf(Pt,n,void 0,void 0,Hn);return F.toString(r,oe)}function ia(e){const t=Pt(F.fromString(e,oe));return F.toString(t,oe)}function ca(e){const t=Pt(F.fromString(e,it));return F.toString(t,oe)}function Mn(e){return F.fromString(`${e}`,Dn)}function Ze(e){return Number(F.toString(e,Dn))}function Xo(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Jo(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=(4-t.length%4)%4;return t+"=".repeat(n)}function fa(e){const t=Mn(typeof e.type<"u"?e.type:Vn);if(Ze(t)===ct&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof e.senderPublicKey<"u"?F.fromString(e.senderPublicKey,oe):void 0,r=typeof e.iv<"u"?F.fromString(e.iv,oe):Me(wt),o=F.fromString(e.symKey,oe),s=yo(o,r).encrypt(F.fromString(e.message,it)),i=qn({type:t,sealed:s,iv:r,senderPublicKey:n});return e.encoding===Zt?Xo(i):i}function aa(e){const t=F.fromString(e.symKey,oe),{sealed:n,iv:r}=zt({encoded:e.encoded,encoding:e.encoding}),o=yo(t,r).decrypt(n);if(o===null)throw new Error("Failed to decrypt");return F.toString(o,it)}function ua(e,t){const n=Mn(mt),r=Me(wt),o=F.fromString(e,it),s=qn({type:n,sealed:o,iv:r});return t===Zt?Xo(s):s}function la(e,t){const{sealed:n}=zt({encoded:e,encoding:t});return F.toString(n,it)}function qn(e){if(Ze(e.type)===mt)return F.toString(F.concat([e.type,e.sealed]),st);if(Ze(e.type)===ct){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return F.toString(F.concat([e.type,e.senderPublicKey,e.iv,e.sealed]),st)}return F.toString(F.concat([e.type,e.iv,e.sealed]),st)}function zt(e){const t=(e.encoding||st)===Zt?Jo(e.encoded):e.encoded,n=F.fromString(t,st),r=n.slice(na,Wo),o=Wo;if(Ze(r)===ct){const f=o+Hn,u=f+wt,a=n.slice(o,f),l=n.slice(f,u),d=n.slice(u);return{type:r,sealed:d,iv:l,senderPublicKey:a}}if(Ze(r)===mt){const f=n.slice(o),u=Me(wt);return{type:r,sealed:f,iv:u}}const s=o+wt,i=n.slice(o,s),c=n.slice(s);return{type:r,sealed:c,iv:i}}function da(e,t){const n=zt({encoded:e,encoding:t?.encoding});return Qo({type:Ze(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?F.toString(n.senderPublicKey,oe):void 0,receiverPublicKey:t?.receiverPublicKey})}function Qo(e){const t=e?.type||Vn;if(t===ct){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function ha(e){return e.type===ct&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}function pa(e){return e.type===mt}function es(e){const t=Buffer.from(e.x,"base64"),n=Buffer.from(e.y,"base64");return F.concat([new Uint8Array([4]),t,n])}function ga(e,t){const[n,r,o]=e.split("."),s=Buffer.from(Jo(o),"base64");if(s.length!==64)throw new Error("Invalid signature length");const i=s.slice(0,32),c=s.slice(32,64),f=`${n}.${r}`,u=Pt(f),a=es(t);if(!ta.verify(F.concat([i,c]),u,a))throw new Error("Invalid signature");return Ds.decodeJWT(e).payload}const ts="irn";function ba(e){return e?.relay||{protocol:ts}}function ya(e){const t=Vs.RELAY_JSONRPC[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var ma=Object.defineProperty,wa=Object.defineProperties,va=Object.getOwnPropertyDescriptors,ns=Object.getOwnPropertySymbols,Ea=Object.prototype.hasOwnProperty,xa=Object.prototype.propertyIsEnumerable,rs=(e,t,n)=>t in e?ma(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Kn=(e,t)=>{for(var n in t||(t={}))Ea.call(t,n)&&rs(e,n,t[n]);if(ns)for(var n of ns(t))xa.call(t,n)&&rs(e,n,t[n]);return e},Aa=(e,t)=>wa(e,va(t));function os(e,t="-"){const n={},r="relay"+t;return Object.keys(e).forEach(o=>{if(o.startsWith(r)){const s=o.replace(r,""),i=e[o];n[s]=i}}),n}function Ba(e){if(!e.includes("wc:")){const u=on(e);u!=null&&u.includes("wc:")&&(e=u)}e=e.includes("wc://")?e.replace("wc://",""):e,e=e.includes("wc:")?e.replace("wc:",""):e;const t=e.indexOf(":"),n=e.indexOf("?")!==-1?e.indexOf("?"):void 0,r=e.substring(0,t),o=e.substring(t+1,n).split("@"),s=typeof n<"u"?e.substring(n):"",i=new URLSearchParams(s),c=Object.fromEntries(i.entries()),f=typeof c.methods=="string"?c.methods.split(","):void 0;return{protocol:r,topic:ss(o[0]),version:parseInt(o[1],10),symKey:c.symKey,relay:os(c),methods:f,expiryTimestamp:c.expiryTimestamp?parseInt(c.expiryTimestamp,10):void 0}}function ss(e){return e.startsWith("//")?e.substring(2):e}function is(e,t="-"){const n="relay",r={};return Object.keys(e).forEach(o=>{const s=o,i=n+t+s;e[s]&&(r[i]=e[s])}),r}function Sa(e){const t=new URLSearchParams,n=Kn(Kn(Aa(Kn({},is(e.relay)),{symKey:e.symKey}),e.expiryTimestamp&&{expiryTimestamp:e.expiryTimestamp.toString()}),e.methods&&{methods:e.methods.join(",")});return Object.entries(n).sort(([r],[o])=>r.localeCompare(o)).forEach(([r,o])=>{o!==void 0&&t.append(r,String(o))}),`${e.protocol}:${e.topic}@${e.version}?${t}`}function Ia(e,t,n){return`${e}?wc_ev=${n}&topic=${t}`}var Oa=Object.defineProperty,Na=Object.defineProperties,Ra=Object.getOwnPropertyDescriptors,cs=Object.getOwnPropertySymbols,Ua=Object.prototype.hasOwnProperty,_a=Object.prototype.propertyIsEnumerable,fs=(e,t,n)=>t in e?Oa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ta=(e,t)=>{for(var n in t||(t={}))Ua.call(t,n)&&fs(e,n,t[n]);if(cs)for(var n of cs(t))_a.call(t,n)&&fs(e,n,t[n]);return e},Ca=(e,t)=>Na(e,Ra(t));function ze(e){const t=[];return e.forEach(n=>{const[r,o]=n.split(":");t.push(`${r}:${o}`)}),t}function as(e){const t=[];return Object.values(e).forEach(n=>{t.push(...ze(n.accounts))}),t}function us(e,t){const n=[];return Object.values(e).forEach(r=>{ze(r.accounts).includes(t)&&n.push(...r.methods)}),n}function ls(e,t){const n=[];return Object.values(e).forEach(r=>{ze(r.accounts).includes(t)&&n.push(...r.events)}),n}function $a(e,t){const n=xs(e,t);if(n)throw new Error(n.message);const r={};for(const[o,s]of Object.entries(e))r[o]={methods:s.methods,events:s.events,chains:s.accounts.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)};return r}function ja(e){var t;const{proposal:{requiredNamespaces:n,optionalNamespaces:r={}},supportedNamespaces:o}=e,s=vt(n),i=vt(r),c={};Object.keys(o).forEach(a=>{const l=o[a].chains,d=o[a].methods,h=o[a].events,y=o[a].accounts;l.forEach(m=>{if(!y.some(v=>v.includes(m)))throw new Error(`No accounts provided for chain ${m} in namespace ${a}`)}),c[a]={chains:l,methods:d,events:h,accounts:y}});const f=Bs(n,c,"approve()");if(f)throw new Error(f.message);const u={};if(!Object.keys(n).length&&!Object.keys(r).length)return c;Object.keys(s).forEach(a=>{const l=o[a].chains.filter(m=>{var v,R;return(R=(v=s[a])==null?void 0:v.chains)==null?void 0:R.includes(m)}),d=o[a].methods.filter(m=>{var v,R;return(R=(v=s[a])==null?void 0:v.methods)==null?void 0:R.includes(m)}),h=o[a].events.filter(m=>{var v,R;return(R=(v=s[a])==null?void 0:v.events)==null?void 0:R.includes(m)}),y=l.map(m=>o[a].accounts.filter(v=>v.includes(`${m}:`))).flat();u[a]={chains:l,methods:d,events:h,accounts:y}}),Object.keys(i).forEach(a=>{var l,d,h,y,m,v;if(!o[a])return;const R=(d=(l=i[a])==null?void 0:l.chains)==null?void 0:d.filter(D=>o[a].chains.includes(D)),Z=o[a].methods.filter(D=>{var j,L;return(L=(j=i[a])==null?void 0:j.methods)==null?void 0:L.includes(D)}),_=o[a].events.filter(D=>{var j,L;return(L=(j=i[a])==null?void 0:j.events)==null?void 0:L.includes(D)}),z=R?.map(D=>o[a].accounts.filter(j=>j.includes(`${D}:`))).flat();u[a]={chains:ae((h=u[a])==null?void 0:h.chains,R),methods:ae((y=u[a])==null?void 0:y.methods,Z),events:ae((m=u[a])==null?void 0:m.events,_),accounts:ae((v=u[a])==null?void 0:v.accounts,z)}});for(const[a,l]of Object.entries(u))(l.accounts.length===0||((t=l?.chains)==null?void 0:t.length)===0)&&delete u[a];return u}function Fn(e){return e.includes(":")}function ds(e){return Fn(e)?e.split(":")[0]:e}function vt(e){var t,n,r;const o={};if(!Gt(e))return o;for(const[s,i]of Object.entries(e)){const c=Fn(s)?[s]:i.chains,f=i.methods||[],u=i.events||[],a=ds(s);o[a]=Ca(Ta({},o[a]),{chains:ae(c,(t=o[a])==null?void 0:t.chains),methods:ae(f,(n=o[a])==null?void 0:n.methods),events:ae(u,(r=o[a])==null?void 0:r.events)})}return o}function hs(e){const t={};return e?.forEach(n=>{var r;const[o,s]=n.split(":");t[o]||(t[o]={accounts:[],chains:[],events:[],methods:[]}),t[o].accounts.push(n),(r=t[o].chains)==null||r.push(`${o}:${s}`)}),t}function La(e,t){t=t.map(r=>r.replace("did:pkh:",""));const n=hs(t);for(const[r,o]of Object.entries(n))o.methods?o.methods=ae(o.methods,e):o.methods=e,o.events=["chainChanged","accountsChanged"];return n}function Pa(e,t){var n,r,o,s,i,c;const f=vt(e),u=vt(t),a={},l=Object.keys(f).concat(Object.keys(u));for(const d of l)a[d]={chains:ae((n=f[d])==null?void 0:n.chains,(r=u[d])==null?void 0:r.chains),methods:ae((o=f[d])==null?void 0:o.methods,(s=u[d])==null?void 0:s.methods),events:ae((i=f[d])==null?void 0:i.events,(c=u[d])==null?void 0:c.events)};return a}const ps={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},gs={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Ae(e,t){const{message:n,code:r}=gs[e];return{message:t?`${n} ${t}`:n,code:r}}function Ge(e,t){const{message:n,code:r}=ps[e];return{message:t?`${n} ${t}`:n,code:r}}function Et(e,t){return Array.isArray(e)?typeof t<"u"&&e.length?e.every(t):!0:!1}function Gt(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function Ve(e){return typeof e>"u"}function fe(e,t){return t&&Ve(e)?!0:typeof e=="string"&&!!e.trim().length}function Yt(e,t){return t&&Ve(e)?!0:typeof e=="number"&&!isNaN(e)}function ka(e,t){const{requiredNamespaces:n}=t,r=Object.keys(e.namespaces),o=Object.keys(n);let s=!0;return Se(o,r)?(r.forEach(i=>{const{accounts:c,methods:f,events:u}=e.namespaces[i],a=ze(c),l=n[i];(!Se(Bt(i,l),a)||!Se(l.methods,f)||!Se(l.events,u))&&(s=!1)}),s):!1}function xt(e){return fe(e,!1)&&e.includes(":")?e.split(":").length===2:!1}function bs(e){if(fe(e,!1)&&e.includes(":")){const t=e.split(":");if(t.length===3){const n=t[0]+":"+t[1];return!!t[2]&&xt(n)}}return!1}function Da(e){function t(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(fe(e,!1)){if(t(e))return!0;const n=on(e);return t(n)}}catch{}return!1}function Va(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function Ha(e){return e?.topic}function Ma(e,t){let n=null;return fe(e?.publicKey,!1)||(n=Ae("MISSING_OR_INVALID",`${t} controller public key should be a string`)),n}function Zn(e){let t=!0;return Et(e)?e.length&&(t=e.every(n=>fe(n,!1))):t=!1,t}function ys(e,t,n){let r=null;return Et(t)&&t.length?t.forEach(o=>{r||xt(o)||(r=Ge("UNSUPPORTED_CHAINS",`${n}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):xt(e)||(r=Ge("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function ms(e,t,n){let r=null;return Object.entries(e).forEach(([o,s])=>{if(r)return;const i=ys(o,Bt(o,s),`${t} ${n}`);i&&(r=i)}),r}function ws(e,t){let n=null;return Et(e)?e.forEach(r=>{n||bs(r)||(n=Ge("UNSUPPORTED_ACCOUNTS",`${t}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=Ge("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function vs(e,t){let n=null;return Object.values(e).forEach(r=>{if(n)return;const o=ws(r?.accounts,`${t} namespace`);o&&(n=o)}),n}function Es(e,t){let n=null;return Zn(e?.methods)?Zn(e?.events)||(n=Ge("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):n=Ge("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),n}function zn(e,t){let n=null;return Object.values(e).forEach(r=>{if(n)return;const o=Es(r,`${t}, namespace`);o&&(n=o)}),n}function qa(e,t,n){let r=null;if(e&&Gt(e)){const o=zn(e,t);o&&(r=o);const s=ms(e,t,n);s&&(r=s)}else r=Ae("MISSING_OR_INVALID",`${t}, ${n} should be an object with data`);return r}function xs(e,t){let n=null;if(e&&Gt(e)){const r=zn(e,t);r&&(n=r);const o=vs(e,t);o&&(n=o)}else n=Ae("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return n}function As(e){return fe(e.protocol,!0)}function Ka(e,t){let n=!1;return t&&!e?n=!0:e&&Et(e)&&e.length&&e.forEach(r=>{n=As(r)}),n}function Fa(e){return typeof e=="number"}function Za(e){return typeof e<"u"&&typeof e!==null}function za(e){return!(!e||typeof e!="object"||!e.code||!Yt(e.code,!1)||!e.message||!fe(e.message,!1))}function Ga(e){return!(Ve(e)||!fe(e.method,!1))}function Ya(e){return!(Ve(e)||Ve(e.result)&&Ve(e.error)||!Yt(e.id,!1)||!fe(e.jsonrpc,!1))}function Wa(e){return!(Ve(e)||!fe(e.name,!1))}function Xa(e,t){return!(!xt(t)||!as(e).includes(t))}function Ja(e,t,n){return fe(n,!1)?us(e,t).includes(n):!1}function Qa(e,t,n){return fe(n,!1)?ls(e,t).includes(n):!1}function Bs(e,t,n){let r=null;const o=eu(e),s=tu(t),i=Object.keys(o),c=Object.keys(s),f=Ss(Object.keys(e)),u=Ss(Object.keys(t)),a=f.filter(l=>!u.includes(l));return a.length&&(r=Ae("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${a.toString()}
      Received: ${Object.keys(t).toString()}`)),Se(i,c)||(r=Ae("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${i.toString()}
      Approved: ${c.toString()}`)),Object.keys(t).forEach(l=>{if(!l.includes(":")||r)return;const d=ze(t[l].accounts);d.includes(l)||(r=Ae("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${l}
        Required: ${l}
        Approved: ${d.toString()}`))}),i.forEach(l=>{r||(Se(o[l].methods,s[l].methods)?Se(o[l].events,s[l].events)||(r=Ae("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${l}`)):r=Ae("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${l}`))}),r}function eu(e){const t={};return Object.keys(e).forEach(n=>{var r;n.includes(":")?t[n]=e[n]:(r=e[n].chains)==null||r.forEach(o=>{t[o]={methods:e[n].methods,events:e[n].events}})}),t}function Ss(e){return[...new Set(e.map(t=>t.includes(":")?t.split(":")[0]:t))]}function tu(e){const t={};return Object.keys(e).forEach(n=>{if(n.includes(":"))t[n]=e[n];else{const r=ze(e[n].accounts);r?.forEach(o=>{t[o]={accounts:e[n].accounts.filter(s=>s.includes(`${o}:`)),methods:e[n].methods,events:e[n].events}})}}),t}function nu(e,t){return Yt(e,!1)&&e<=t.max&&e>=t.min}function ru(){const e=He();return new Promise(t=>{switch(e){case ne.browser:t(Is());break;case ne.reactNative:t(Os());break;case ne.node:t(Ns());break;default:t(!0)}})}function Is(){return Xe()&&navigator?.onLine}async function Os(){if(Be()&&typeof global<"u"&&global!=null&&global.NetInfo){const e=await(global==null?void 0:global.NetInfo.fetch());return e?.isConnected}return!0}function Ns(){return!0}function ou(e){switch(He()){case ne.browser:Rs(e);break;case ne.reactNative:Us(e);break;case ne.node:break}}function Rs(e){!Be()&&Xe()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)))}function Us(e){Be()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(t=>e(t?.isConnected))}function su(){var e;return Xe()&&ye.getDocument()?((e=ye.getDocument())==null?void 0:e.visibilityState)==="visible":!0}const Gn={};class iu{static get(t){return Gn[t]}static set(t,n){Gn[t]=n}static delete(t){delete Gn[t]}}function _s(e){const t=ut.default.decode(e);if(t.length<33)throw new Error("Too short to contain a public key");return t.slice(1,33)}function Ts({publicKey:e,signature:t,payload:n}){var r;const o=Yn(n.method),s=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),i=fu(n.address),c=n.era==="00"?new Uint8Array([0]):Yn(n.era);if(c.length!==1&&c.length!==2)throw new Error("Invalid era length");const f=parseInt(n.nonce,16),u=new Uint8Array([f&255,f>>8&255]),a=BigInt(`0x${cu(n.tip)}`),l=uu(a),d=new Uint8Array([0,...e,i,...t,...c,...u,...l,...o]),h=au(d.length+1);return new Uint8Array([...h,s,...d])}function Cs(e){const t=Yn(e),n=Hs.blake2b(t,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function Yn(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(t=>parseInt(t,16)))}function cu(e){return e.startsWith("0x")?e.slice(2):e}function fu(e){const t=ut.default.decode(e)[0];return t===42?0:t===60?2:1}function au(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){const t=e<<2|1;return new Uint8Array([t&255,t>>8&255])}else if(e<1<<30){const t=e<<2|2;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function uu(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){const t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}else if(e<BigInt(1)<<BigInt(30)){const t=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function lu(e){const t=Uint8Array.from(Buffer.from(e.signature,"hex")),n=_s(e.transaction.address),r=Ts({publicKey:n,signature:t,payload:e.transaction}),o=Buffer.from(r).toString("hex");return Cs(o)}exports.BASE10=Dn,exports.BASE16=oe,exports.BASE64=st,exports.BASE64URL=Zt,exports.COLON=ei,exports.DEFAULT_DEPTH=en,exports.EMPTY_SPACE=St,exports.ENV_MAP=ne,exports.INTERNAL_ERRORS=gs,exports.LimitedSet=Ui,exports.MemoryStore=iu,exports.ONE_THOUSAND=ti,exports.REACT_NATIVE_PRODUCT=fr,exports.RELAYER_DEFAULT_PROTOCOL=ts,exports.SDK_ERRORS=ps,exports.SDK_TYPE=ur,exports.SLASH=ar,exports.TYPE_0=Vn,exports.TYPE_1=ct,exports.TYPE_2=mt,exports.UTF8=it,exports.addResourceToRecap=oo,exports.addSignatureToExtrinsic=Ts,exports.appendToQueryString=lr,exports.assertType=ai,exports.assignAbilityToActions=gn,exports.base64Decode=no,exports.base64Encode=to,exports.buildApprovedNamespaces=ja,exports.buildAuthObject=Tc,exports.buildNamespacesFromAuth=La,exports.buildRecapStatement=io,exports.buildSignedExtrinsicHash=lu,exports.calcExpiry=Ei,exports.capitalize=gi,exports.capitalizeWord=mr,exports.createDelayedPromise=bi,exports.createEncodedRecap=Lc,exports.createExpiringPromise=yi,exports.createRecap=ro,exports.decodeRecap=Pe,exports.decodeTypeByte=Ze,exports.decodeTypeTwoEnvelope=la,exports.decrypt=aa,exports.deriveExtrinsicHash=Cs,exports.deriveSymKey=sa,exports.deserialize=zt,exports.encodeRecap=Ct,exports.encodeTypeByte=Mn,exports.encodeTypeTwoEnvelope=ua,exports.encrypt=fa,exports.engineEvent=Ai,exports.enumify=pi,exports.extractSolanaTransactionId=wc,exports.formatAccountId=tr,exports.formatAccountWithChain=qs,exports.formatChainId=er,exports.formatDeeplinkUrl=wr,exports.formatExpirerTarget=nn,exports.formatIdTarget=wi,exports.formatMessage=Xr,exports.formatMessageContext=ui,exports.formatRelayParams=is,exports.formatRelayRpcUrl=ci,exports.formatStatementFromRecap=yn,exports.formatTopicTarget=mi,exports.formatUA=gr,exports.formatUri=Sa,exports.fromBase64=on,exports.generateKeyPair=ra,exports.generateRandomBytes32=oa,exports.getAccountsChains=ze,exports.getAccountsFromNamespaces=Fs,exports.getAddressFromAccount=nr,exports.getAddressesFromAccounts=Ks,exports.getAlgorandTransactionId=xc,exports.getAppId=oi,exports.getAppMetadata=dr,exports.getBrowserOnlineStatus=Is,exports.getChainFromAccount=rr,exports.getChainsFromAccounts=or,exports.getChainsFromNamespace=Bt,exports.getChainsFromNamespaces=Zs,exports.getChainsFromRecap=Dc,exports.getChainsFromRequiredNamespaces=zs,exports.getCommonValuesInArrays=rn,exports.getCryptoKeyFromKeyData=es,exports.getDecodedRecapFromResources=Jr,exports.getDeepLink=Si,exports.getDidAddress=pn,exports.getDidAddressSegments=Tt,exports.getDidChainId=Yr,exports.getEnvironment=He,exports.getHttpUrl=fi,exports.getInternalError=Ae,exports.getJavascriptID=pr,exports.getJavascriptOS=hr,exports.getLastItems=yr,exports.getLinkModeURL=Ia,exports.getMethodsFromRecap=kc,exports.getNamespacedDidChainId=Wr,exports.getNamespacesChains=as,exports.getNamespacesEventsForChainId=ls,exports.getNamespacesFromAccounts=hs,exports.getNamespacesMethodsForChainId=us,exports.getNearTransactionIdFromSignedTransaction=Ec,exports.getNearUint8ArrayFromBytes=Fr,exports.getNodeOnlineStatus=Ns,exports.getReCapActions=eo,exports.getReactNativeOnlineStatus=Os,exports.getRecapAbilitiesFromResource=jc,exports.getRecapFromResources=$t,exports.getRecapResource=Qr,exports.getRelayClientMetadata=ii,exports.getRelayProtocolApi=ya,exports.getRelayProtocolName=ba,exports.getRequiredNamespacesFromNamespaces=$a,exports.getSdkError=Ge,exports.getSearchParamFromURL=Ii,exports.getSignDirectHash=Ac,exports.getSuiDigest=vc,exports.getUniqueValues=Jt,exports.getWalletSendCallsHashes=Bc,exports.handleDeeplinkRedirect=Bi,exports.hasOverlap=Se,exports.hashEthereumMessage=ln,exports.hashKey=ia,exports.hashMessage=ca,exports.isAndroid=ni,exports.isAppVisible=su,exports.isBrowser=Xe,exports.isCaipNamespace=Fn,exports.isConformingNamespaces=Bs,exports.isExpired=xi,exports.isIframe=xr,exports.isIos=ri,exports.isNode=tn,exports.isOnline=ru,exports.isProposalStruct=Va,exports.isReactNative=Be,exports.isRecap=bn,exports.isSessionCompatible=ka,exports.isSessionStruct=Ha,exports.isTelegram=Er,exports.isTestRun=Ni,exports.isTypeOneEnvelope=ha,exports.isTypeTwoEnvelope=pa,exports.isUndefined=Ve,exports.isValidAccountId=bs,exports.isValidAccounts=ws,exports.isValidActions=Es,exports.isValidArray=Et,exports.isValidChainId=xt,exports.isValidChains=ys,exports.isValidController=Ma,exports.isValidEip1271Signature=Kr,exports.isValidEip191Signature=qr,exports.isValidErrorReason=za,exports.isValidEvent=Wa,exports.isValidId=Fa,exports.isValidNamespaceAccounts=vs,exports.isValidNamespaceActions=zn,exports.isValidNamespaceChains=ms,exports.isValidNamespaceMethodsOrEvents=Zn,exports.isValidNamespaces=xs,exports.isValidNamespacesChainId=Xa,exports.isValidNamespacesEvent=Qa,exports.isValidNamespacesRequest=Ja,exports.isValidNumber=Yt,exports.isValidObject=Gt,exports.isValidParams=Za,exports.isValidRecap=be,exports.isValidRelay=As,exports.isValidRelays=Ka,exports.isValidRequest=Ga,exports.isValidRequestExpiry=nu,exports.isValidRequiredNamespaces=qa,exports.isValidResponse=Ya,exports.isValidString=fe,exports.isValidUrl=Da,exports.mapEntries=hi,exports.mapToObj=li,exports.mergeArrays=ae,exports.mergeEncodedRecaps=Pc,exports.mergeRecaps=so,exports.mergeRequiredAndOptionalNamespaces=Pa,exports.normalizeNamespaces=vt,exports.objToMap=di,exports.openDeeplink=vr,exports.parseAccountId=Xt,exports.parseChainId=Wt,exports.parseContextNames=br,exports.parseExpirerTarget=vi,exports.parseNamespaceKey=ds,exports.parseRelayParams=os,exports.parseTopic=ss,exports.parseUri=Ba,exports.populateAppMetadata=si,exports.populateAuthPayload=Cc,exports.recapHasResource=$c,exports.serialize=qn,exports.sleep=Ri,exports.ss58AddressToPublicKey=_s,exports.subscribeToBrowserNetworkChange=Rs,exports.subscribeToNetworkChange=ou,exports.subscribeToReactNativeNetworkChange=Us,exports.toBase64=Ar,exports.uuidv4=Oi,exports.validateDecoding=da,exports.validateEncoding=Qo,exports.validateSignedCacao=_c,exports.verifyP256Jwt=ga,exports.verifySignature=Mr;
//# sourceMappingURL=index.cjs.js.map
